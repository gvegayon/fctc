webpackJsonp([2],{242:function(t,e,n){var i,o;i=[e,n(20),n(249),n(251),n(38),n(22),n(0),n(14),n(41)],void 0!==(o=function(t,e,n,i,o,s,r,a,c){"use strict";function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.onVideoContainerNavigation=t.checkElemsForVideos=void 0;var d=l(e),u=l(i),m=l(o),p=l(s),h=l(r),f=l(a),g=l(c),v={},b=function(t){return t.split("/")[0]},y=function(t){var e=v[t].player,n=v[t].pendingTrackingCalls;if(n.length){e.duration||(e.duration=e.getDuration());var i=e.getCurrentTime();Math.round(i/e.duration*100)>=n[0]&&(u.default.track(n[0],b(t)),n.shift())}},w=function(t){v[t].progressTracker&&clearInterval(v[t].progressTracker)},C=function(t){return v[t].progressTracker=setInterval(y.bind(null,t),1e3)},_=function(t){var e=v[t];w(t),C(t),u.default.track("play",b(t));var n=e.iframe&&e.iframe.closest(".immersive-main-media")||null;n&&n.classList.add("atom-playing"),e.endSlate&&!e.overlay.parentNode.querySelector(".end-slate-container")&&e.endSlate.fetch(e.overlay.parentNode,"html")},x=function(t){return w(t)},k=function(t){var e=v[t];w(t),u.default.track("end",b(t)),e.pendingTrackingCalls=[25,50,75];var n=e.iframe&&e.iframe.closest(".immersive-main-media")||null;n&&n.classList.remove("atom-playing")},S={ENDED:k,PLAYING:_,PAUSED:x},T=function(t,e,n){e===window.YT.PlayerState[n]&&S[n]&&S[n](t)},E=function(t){return"Video"===h.default.page.contentType&&function(){return h.default.page.isDev?0===document.referrer.indexOf(window.location.origin):0===document.referrer.indexOf(h.default.page.host)}()&&!function(){return f.default.isIOS()||f.default.isAndroid()}()&&function(){return v[t].iframe&&v[t].iframe.closest('figure[data-component="main video"]')||!1}()},j=function(t){var e=t.parentNode,n=e?e.dataset.endSlate:null,i=new m.default;return i.endpoint=n,i},I=function(){var t=document.querySelector(".immersive-main-media__media .youtube-media-atom"),e=t?t.offsetHeight:0,n=document.querySelector(".immersive-main-media__headline-container"),i=n?n.offsetHeight:0,o=e-i,s=document.querySelector(".youtube-media-atom__immersive-interface");s&&(s.style.top=o+"px")},P=function(t,e,n,i){v[t]={player:i.target,pendingTrackingCalls:[25,50,75],iframe:n},E(t)&&i.target.playVideo(),e&&(v[t].overlay=e,h.default.page.section&&f.default.isBreakpoint({min:"desktop"})&&(v[t].endSlate=j(e))),n&&n.closest(".immersive-main-media__media")&&(I(),window.addEventListener("resize",(0,g.default)(I.bind(null),200)))},A=function(t,e){return Object.keys(S).forEach(T.bind(null,t,e.data))},R=function(t){t&&d.default.read(function(){(0,p.default)(".youtube-media-atom",t).each(function(t,e){var i=t.querySelector("iframe");if(i){i.id+="/"+e;var o=t.getAttribute("data-media-atom-id")+"/"+e;t.setAttribute("data-unique-atom-id",o);var s=t.querySelector(".youtube-media-atom__overlay");u.default.init(b(o)),(0,n.initYoutubePlayer)(i,{onPlayerReady:P.bind(null,o,s,i),onPlayerStateChange:A.bind(null,o)},i.id)}})})};t.checkElemsForVideos=function(t){t&&t.length?t.forEach(R):R(document.body)},t.onVideoContainerNavigation=function(t){var e=v[t];e&&e.player.pauseVideo()}}.apply(e,i))&&(t.exports=o)},397:function(t,e,n){var i,o;i=[n(131),n(139),n(0)],void 0!==(o=function(t,e,n){var i=n.page.discussionApiUrl,o={root:i,clientHeader:n.page.discussionApiClientHeader,d2Uid:n.page.discussionD2Uid};return o.send=function(t,n,i){return i=i||{},e.ajax({url:o.root+t,type:"get"===n?"jsonp":"json",method:n,crossOrigin:!0,data:i,headers:{"D2-X-UID":o.d2Uid,"GU-Client":o.clientHeader},withCredentials:!0})},o.postComment=function(t,e){var n="/discussion/"+t+"/comment"+(e.replyTo?"/"+e.replyTo.commentId+"/reply":"");return o.send(n,"post",e)},o.previewComment=function(t){return o.send("/comment/preview","post",t)},o.recommendComment=function(t){var e="/comment/"+t+"/recommend";return o.send(e,"post")},o.pickComment=function(t){var e="/comment/"+t+"/highlight";return o.send(e,"post")},o.unPickComment=function(t){var e="/comment/"+t+"/unhighlight";return o.send(e,"post")},o.reportComment=function(t,e){var n="/comment/"+t+"/reportAbuse";return o.send(n,"post",e)},o.getUser=function(t){var e="/profile/"+(t||"me");return o.send(e,"get")},o}.apply(e,i))&&(t.exports=o)},404:function(t,e,n){var i,o;i=[t,e,n(139),n(0)],void 0!==(o=function(t,e,n,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return t&&t.__esModule?t:{default:t}}(i),s=o.default.page.avatarApiUrl+"/v1",r=o.default.page.avatarImagesUrl+"/user",a=function(t,e,i){var o={url:s+e,type:"json",data:i||{},processData:!1,method:t,crossOrigin:!0,withCredentials:!0};return(0,n.ajax)(o)},c=function(){return a("GET","/avatars/user/me/active")},l=function(t){return a("POST","/avatars",t)},d=function(t){return r+"/"+t};e.default={request:a,getActive:c,updateAvatar:l,deterministicUrl:d},t.exports=e.default}.apply(e,i))&&(t.exports=o)},412:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},413:function(t,e,n){var i,o;i=[n(20),n(5),n(22),n(0),n(232),n(4),n(132),n(423),n(14),n(567),n(483),n(83),n(486),n(865),n(866),n(868),n(609)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u,m,p,h,f,g){function v(t,n){if(window.location.hash)n();else{var i=e(t)[0];i&&a.add(i,1500,n)}}function b(){i.page.isFront||v(".js-popular-trails",function(){(new p).init()})}function y(){i.page.seriesId||i.page.blogIds||v(".js-related",function(){var t={excludeTags:[]};"paid-content"!==i.page.sponsorshipType&&t.excludeTags.push("tone/advertisement-features"),"contentType"in i.page&&o(["video","interactive"],i.page.contentType.toLowerCase())&&t.excludeTags.push("guardian-professional/guardian-professional"),new h(t).renderRelatedComponent()})}function w(){v(".js-onward",function(){(i.page.seriesId||i.page.blogIds)&&i.page.showRelatedContent?new m(e(".js-onward")):""!==i.page.tones&&n(".js-onward").each(function(t){(new f).fetch(t,"html")})})}function C(){if(i.switches.discussion&&i.page.commentable){var t=e(".discussion")[0];t&&(new d).attachTo(t)}}function _(){if(!u.isUserLoggedIn()){var i=n(".js-comments");t.write(function(){if(i.appendTo(e(".js-repositioned-comments")),"#comments"===window.location.hash){var t=i.offset().top;n(document.body).scrollTop(t)}})}}return function(){r.catchErrorsWithContext([["c-discussion",C],["c-comments",_],["c-shares",g.loadShareCounts],["c-popular",b],["c-related",y],["c-onward",w],["c-comment-adverts",l]])}}.apply(e,i))&&(t.exports=o)},414:function(t,e,n){var i,o;i=[],void 0!==(o=function(){function t(t,i,o){t=+t||0,o="number"==typeof o?o:+o||1,null==i&&(i=t,t=0);for(var s=-1,r=n(0,e((i-t)/(o||1))),a=Array(r);++s<r;)a[s]=t,t+=o;return a}var e=Math.ceil,n=Math.max;return t}.apply(e,i))&&(t.exports=o)},415:function(t,e,n){var i,o;i=[n(63),n(30),n(10),n(2)],void 0!==(o=function(t,e,n,i){function o(o){var l=!0;if(!o)return l;var u=d.call(o),m=o.length;return u==r||u==c||(i.argsClass?u==s:e(o))||u==a&&"number"==typeof m&&n(o.splice)?!m:(t(o,function(){return l=!1}),l)}var s="[object Arguments]",r="[object Array]",a="[object Object]",c="[object String]",l=Object.prototype,d=l.toString;return o}.apply(e,i))&&(t.exports=o)},423:function(t,e,n){var i,o;i=[n(15),n(4),n(20),n(399),n(41)],void 0!==(o=function(t,e,n,i,o){function s(t,n){var i={conditionFn:t,loadFn:n};c.push(i),1===c.length&&e.on("window:throttledScroll",d),a()}function r(e,i,o){n.read(function(){var n=t(e);s(function(){var t=n.offset(),e=t.top-i,o=t.top+t.height+i;return l.top>e&&l.bottom<o},o)})}var a,c=[],l={top:0,bottom:0},d=function(){l.top=window.pageYOffset,l.bottom=l.top+t.viewport().height,c=i(c,function(t){if(!t.conditionFn())return!0;t.loadFn()}),0===c.length&&e.off("window:throttledScroll",d)};return a=o(d,2e3),{add:r}}.apply(e,i))&&(t.exports=o)},424:function(t,e,n){(function(t){var i,o;i=[n(131)],void 0!==(o=function(t){function e(e){for(var n in e)e.hasOwnProperty(n)&&t.set(o+"."+n,e[n])}function n(e){return!1!==t.get(o+"."+e)}function i(t){return!0===n(t)}var o="accessibility";return{KEY_PREFIX:o,saveState:e,isOn:i}}.apply(e,i))&&(t.exports=o)}).call(e,n(412)(t))},427:function(t,e,n){var i,o;i=[n(22),n(23),n(15),n(0),n(4),n(397),n(83),n(38),n(428),n(430)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l){function d(t){this.setOptions(t),o.on("module:identity:validation-email:success",this.verificationEmailSuccess.bind(this)),o.on("module:identity:validation-email:fail",this.verificationEmailFail.bind(this))}return a.define(d),d.prototype.useBem=!0,d.prototype.templateName="comment-box",d.prototype.componentClass="d-comment-box",d.prototype.classes={},d.prototype.errorMessages={EMPTY_COMMENT_BODY:"Please write a comment.",COMMENT_TOO_LONG:"Your comment must be fewer than 5000 characters long.",USER_BANNED:'Commenting has been disabled for this account (<a href="/community-faqs#321a">why?</a>).',DISCUSSION_CLOSED:"Sorry your comment can not be published as the discussion is now closed for comments.",PARENT_COMMENT_MODERATED:"Sorry the comment can not be published as the comment you replied to has been moderated since.",COMMENT_RATE_LIMIT_EXCEEDED:"You can only post one comment every minute. Please try again in a moment.",INVALID_PROTOCOL:"Sorry your comment can not be published as it was not sent over a secure channel. Please report us this issue using the technical issue link in the page footer.",AUTH_COOKIE_INVALID:"Sorry, your comment was not published as you are no longer signed in. Please sign in and try again.","READ-ONLY-MODE":"Sorry your comment can not currently be published as commenting is undergoing maintenance but will be back shortly. Please try again in a moment.",API_CORS_BLOCKED:"Could not post due to your internet settings, which might be controlled by your provider. Please contact your administrator or disable any proxy servers or VPNs and try again.",API_ERROR:"Sorry, there was a problem posting your comment.  Please try another browser or network connection.  Reference code ",EMAIL_VERIFIED:'<span class="d-comment-box__error-meta">Sent. Please check your email to verify  your email address. Once verified post your comment.</span>',EMAIL_VERIFIED_FAIL:'We are having technical difficulties. Please try again later or <a href="/send/email" class="js-id-send-validation-email"><strong>resend the verification</strong></a>.',EMAIL_NOT_VALIDATED:'Please confirm your email address to comment.<br />If you can\'t find the email, we can <a href="_#" class="js-id-send-validation-email"><strong>resend the verification email</strong></a> to  your email address.'},d.prototype.defaultOptions={discussionId:null,apiRoot:null,maxLength:5e3,premod:!1,newCommenter:!1,hasUsername:!0,focus:!1,state:"top-level",replyTo:null,priorToVerificationDate:new Date(1392719401337)},d.prototype.errors=[],d.prototype.getUserData=function(){return r.getUserFromCookie()},d.prototype.prerender=function(){this.options.premod||this.getElem("premod").parentNode.removeChild(this.getElem("premod"));var t=this.getUserData();if(this.getElem("author").innerHTML=t.displayName,"response"===this.options.state)this.getElem("submit").innerHTML="Post reply";else if(this.options.shouldRenderMainAvatar){var e=this.getElem("avatar-wrapper");e.setAttribute("userid",t.id),e.setAttribute("data-userid",t.id),c.avatarify(e)}else{var n=document.getElementsByClassName("d-comment-box__meta")[0];n&&n.parentNode.removeChild(n)}if(this.options.replyTo){var i=this.getElem("reply-to-author");i.innerHTML=this.options.replyTo.author,this.getElem("parent-comment-author").innerHTML=this.options.replyTo.author+" @ "+this.options.replyTo.timestamp+" said:",this.getElem("parent-comment-body").innerHTML=this.options.replyTo.body;var o=function(){var t=i.offsetLeft+i.getBoundingClientRect().width/2;this.getElem("parent-comment-spout").style.marginLeft=t+"px"};window.setTimeout(o.bind(this),0)}},d.prototype.showOnboarding=function(t){t.preventDefault(),this.hasState("onboarding-visible")||!this.options.newCommenter?(this.options.hasUsername&&this.removeState("onboarding-visible"),this.postComment()):(this.getElem("onboarding-author").innerHTML=this.getUserData().displayName,this.setState("onboarding-visible"),this.previewComment(this.onboardingPreviewSuccess),this.options.hasUsername&&this.getElem("onboarding-username").classList.add("is-hidden"))},d.prototype.hideOnboarding=function(t){t.preventDefault(),this.removeState("onboarding-visible")},d.prototype.ready=function(){if(null===this.getDiscussionId())throw new Error('CommentBox: You need to set the "data-discussion-key" on your element');var t=this.getElem("body");this.setFormState(),this.options.newCommenter?(e.on(document.body,"submit",[this.elem],this.showOnboarding.bind(this)),e.on(document.body,"click",this.getClass("onboarding-cancel"),this.hideOnboarding.bind(this))):e.on(document.body,"submit",[this.elem],this.submitPostComment.bind(this)),e.on(document.body,"change keyup",[t],this.setFormState.bind(this)),e.on(t,"focus",this.setExpanded.bind(this)),this.on("change",".d-comment-box__body",this.resetPreviewComment),this.on("click",this.getClass("preview"),this.previewComment.bind(this,this.previewCommentSuccess)),this.on("click",this.getClass("hide-preview"),this.resetPreviewComment),this.on("click",this.getClass("cancel"),this.cancelComment),this.on("click",this.getClass("show-parent"),this.setState.bind(this,"parent-visible",!1)),this.on("click",this.getClass("hide-parent"),this.removeState.bind(this,"parent-visible",!1)),this.on("click",this.getClass("formatting-bold"),this.formatComment.bind(this,"bold")),this.on("click",this.getClass("formatting-italic"),this.formatComment.bind(this,"italic")),this.on("click",this.getClass("formatting-quote"),this.formatComment.bind(this,"quote")),this.on("click",this.getClass("formatting-link"),this.formatComment.bind(this,"link")),this.setState(this.options.state),this.options.focus&&window.setTimeout(function(){this.getElem("body").focus()}.bind(this),0)},d.prototype.urlify=function(t){var e=new RegExp("\\b((https?://|www.)\\S+)\\b(?![^<]*>|[^<>]*</)","g");return t.replace(e,function(t,e,n){return'<a href="'+("www."===n?"http://"+e:e)+'">'+e+"</a>"})},d.prototype.submitPostComment=function(t){t.preventDefault(),this.postComment()},d.prototype.invalidEmailError=function(){this.removeState("onboarding-visible"),this.error("EMAIL_NOT_VALIDATED"),l.init()},d.prototype.postComment=function(){var t=this,e={body:this.elem.body.value};t.clearErrors();var n=function(){t.removeState("onboarding-visible"),e.body=t.urlify(e.body),t.setFormState(!0),s.postComment(t.getDiscussionId(),e).then(t.postCommentSuccess.bind(t,e),t.fail.bind(t))},i=function(e){o.emit("user:username:updated",e.user.publicFields.username),t.options.hasUsername=!0,t.getElem("onboarding-username").classList.add("is-hidden"),n()},a=function(e){var n=t.getElem("onboarding-username-input");t.setState("onboarding-visible"),n.classList.add("d-comment-box__onboarding-username-error-border");var i=t.getElem("onboarding-username-error-message");i.innerHTML=JSON.parse(e.responseText).errors[0].description,i.classList.remove("is-hidden")},c=function(){""===e.body&&t.error("EMPTY_COMMENT_BODY"),e.body.length>t.options.maxLength&&t.error("COMMENT_TOO_LONG","<b>Comments must be shorter than "+t.options.maxLength+" characters.</b>Yours is currently "+(e.body.length-t.options.maxLength)+" character(s) too long."),t.options.replyTo&&(e.replyTo=t.options.replyTo),0===t.errors.length&&(t.options.newCommenter&&!t.options.hasUsername?r.updateUsername(t.getElem("onboarding-username-input").value).then(i,a):n())};if(t.getUserData().emailVerified)c();else{new Date(t.getUserData().accountCreatedDate)>t.options.priorToVerificationDate?r.getUserFromApiWithRefreshedCookie().then(function(e){!0===e.user.statusFields.userEmailValidated?c():t.invalidEmailError()}):c()}},d.prototype.error=function(t,e){e=e||this.errorMessages[t],this.setState("invalid");var i=n.create('<div class="d-discussion__error '+this.getClass("error",!0)+'"><i class="i i-alert"></i><span class="d-discussion__error-text">'+e+"</span></div>")[0];this.getElem("messages").appendChild(i),this.errors.push(t)},d.prototype.postCommentSuccess=function(t,e){this.options.newCommenter&&(this.refreshUsernameHtml(),this.options.newCommenter=!1),t.id=parseInt(e.message,10),this.getElem("body").value="",this.resetPreviewComment(),this.setFormState(),this.emit("post:success",t),o.emit("discussion:commentbox:post:success",t)},d.prototype.fail=function(t){var e;try{e=JSON.parse(t.responseText)}catch(t){e={}}this.setFormState(),0==t.status?this.error("API_CORS_BLOCKED"):"EMAIL_NOT_VALIDATED"===e.errorCode?this.invalidEmailError():this.errorMessages[e.errorCode]?this.error(e.errorCode):this.error("API_ERROR",this.errorMessages.API_ERROR+t.status)},d.prototype.onboardingPreviewSuccess=function(t,e){this.getElem("onboarding-preview-body").innerHTML=e.commentBody},d.prototype.previewCommentSuccess=function(t,e){this.getElem("preview-body").innerHTML=e.commentBody,this.setState("preview-visible")},d.prototype.getDiscussionId=function(){return this.options.discussionId||this.elem.getAttribute("data-discussion-key").replace("discussion","")},d.prototype.setFormState=function(t){t="boolean"==typeof t&&t;var e=this.getElem("body"),n=this.getElem("submit");t||0===e.value.length?n.setAttribute("disabled","disabled"):n.removeAttribute("disabled")},d.prototype.clearErrors=function(){this.getElem("messages").innerHTML="",this.errors=[],this.removeState("invalid")},d.prototype.setExpanded=function(){this.setState("expanded")},d.prototype.verificationEmailSuccess=function(){this.clearErrors(),this.error("EMAIL_VERIFIED")},d.prototype.verificationEmailFail=function(){this.clearErrors(),this.error("EMAIL_VERIFIED_FAIL")},d.prototype.previewComment=function(t){var e=this,n={body:this.getElem("body").value};e.clearErrors(),""===n.body&&(this.resetPreviewComment(),e.error("EMPTY_COMMENT_BODY")),n.body.length>e.options.maxLength&&e.error("COMMENT_TOO_LONG","<b>Comments must be shorter than "+e.options.maxLength+" characters.</b>Yours is currently "+(n.body.length-e.options.maxLength)+" characters too long."),0===e.errors.length&&s.previewComment(n).then(t.bind(e,n),e.fail.bind(e))},d.prototype.cancelComment=function(){"response"===this.options.state?this.destroy():(this.resetPreviewComment(),this.getElem("body").value="",this.setFormState(),this.removeState("expanded"))},d.prototype.resetPreviewComment=function(){this.removeState("preview-visible"),this.getElem("preview-body").innerHTML=""},d.prototype.formatComment=function(t){var e=this.getElem("body"),n=e.selectionStart,i=e.value.substring(e.selectionStart,e.selectionEnd),o=function(t){e.setSelectionRange(n,n+t.length)},s=function(t,n){var s=t+i+n;e.value=e.value.substring(0,e.selectionStart)+s+e.value.substring(e.selectionEnd),o(s)};switch(t){case"bold":s("<b>","</b>");break;case"italic":s("<i>","</i>");break;case"quote":s("<blockquote>","</blockquote>");break;case"link":!function(){var t,n;/^https?:\/\//i.test(i)?t=i:(n=window.prompt("Your URL:","http://www."),t=n,i=i||n);var o='<a href="'+t+'">'+i+"</a>";e.value=e.value.substring(0,e.selectionStart)+o+e.value.substring(e.selectionEnd)}()}},d.prototype.refreshUsernameHtml=function(){r.reset();var e=this.getUserData().displayName,n=t(".js-profile-info")[0],i=t("._author_tywwu_16")[0];n&&(n.innerHTML=e),i&&(i.innerHTML=e)},d}.apply(e,i))&&(t.exports=o)},428:function(t,e,n){var i,o;i=[n(22),n(15),n(404),n(0)],void 0!==(o=function(t,e,n,i){function o(){t(".user-avatar").each(s)}function s(t){var o=e(t),s=e(e.create('<div class="is-updating"></div>')),r=e(e.create('<img class="user-avatar__image" alt="" />')),a=o.data("userid"),c=i.user?parseInt(i.user.id):null,l=a===c,d=function(){s.remove(),r.appendTo(o)};o.removeClass("is-hidden"),s.css("display","block").appendTo(o),l?n.getActive().then(function(t){r.attr("src",t.data.avatarUrl)},function(){r.attr("src",n.deterministicUrl(a))}).always(function(){d()}):(r.attr("src",n.deterministicUrl(a)),d())}return{init:o,avatarify:s}}.apply(e,i))&&(t.exports=o)},429:function(t,e,n){var i,o;i=[n(23),n(15),n(5),n(22),n(0),n(14),n(488),n(4),n(12),n(62),n(38),n(335),n(189),n(682),n(683),n(684),n(685),n(688),n(687),n(230),n(247),n(445)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u,m,p,h,f,g,v,b,y,w,C){function _(){function a(t){return c(h,{label:t})}this.showEndslate="mobile"!==s.getBreakpoint()&&"childrens-books-site"!==o.page.section&&"Gallery"===o.page.contentType,this.useSwipe=s.hasTouchScreen(),this.swipeThreshold=.05,this.galleryLightboxHtml='<div class="overlay gallery-lightbox gallery-lightbox--closed gallery-lightbox--hover"><div class="gallery-lightbox__sidebar">'+a("close")+'<div class="gallery-lightbox__progress  gallery-lightbox__progress--sidebar"><span class="gallery-lightbox__index js-gallery-index"></span><span class="gallery-lightbox__progress-separator"></span><span class="gallery-lightbox__count js-gallery-count"></span></div>'+a("next")+a("prev")+a("info-button")+'</div><div class="js-gallery-swipe gallery-lightbox__swipe-container"><ul class="gallery-lightbox__content js-gallery-content"></ul></div></div>',this.lightboxEl=e.create(this.galleryLightboxHtml),this.$lightboxEl=e(this.lightboxEl).prependTo(document.body),this.$indexEl=i(".js-gallery-index",this.lightboxEl),this.$countEl=i(".js-gallery-count",this.lightboxEl),this.$contentEl=i(".js-gallery-content",this.lightboxEl),this.nextBtn=n(".js-gallery-next",this.lightboxEl)[0],this.prevBtn=n(".js-gallery-prev",this.lightboxEl)[0],this.closeBtn=n(".js-gallery-close",this.lightboxEl)[0],this.infoBtn=n(".js-gallery-info-button",this.lightboxEl)[0],this.$swipeContainer=i(".js-gallery-swipe"),t.on(this.nextBtn,"click",this.trigger.bind(this,"next")),t.on(this.prevBtn,"click",this.trigger.bind(this,"prev")),t.on(this.closeBtn,"click",this.close.bind(this)),t.on(this.infoBtn,"click",this.trigger.bind(this,"toggle-info")),this.handleKeyEvents=this.handleKeyEvents.bind(this),this.resize=this.trigger.bind(this,"resize"),this.toggleInfo=function(t){e(t.target).hasClass("js-gallery-lightbox-info")||i.ancestor(t.target,"js-gallery-lightbox-info")||this.trigger("toggle-info")}.bind(this),s.hasTouchScreen()&&this.disableHover(),t.on(window,"popstate",function(t){t.state||this.trigger("close")}.bind(this)),this.fsm=new r({initial:"closed",onChangeState:function(t,e){this.$lightboxEl.removeClass("gallery-lightbox--"+t).addClass("gallery-lightbox--"+e)},context:this,states:this.states})}function x(){C.loadCssPromise.then(function(){if("lightboxImages"in o.page&&o.page.lightboxImages.images.length>0){var n,i,s,r,a=window.location.hash,c=o.page.lightboxImages;t.on(document.body,"click",".js-gallerythumbs",function(t){t.preventDefault();var i=e(t.currentTarget),o=i.attr("href")||i.attr("data-gallery-url"),s=o.split("#img-"),r=parseInt(s[1],10),a=isNaN(r)?1:r;n=n||new _,n.loadGalleryfromJson(c,a)}),n=n||new _,i="/"+o.page.pageId,s=/\?index=(\d+)/.exec(document.location.href),s?(l.pushUrl(null,document.title,i,!0),n.loadGalleryfromJson(c,parseInt(s[1],10))):(r=/^#(?:img-)?(\d+)$/.exec(a))&&n.loadGalleryfromJson(c,parseInt(r[1],10))}})}return _.prototype.generateImgHTML=function(t,e){var n=o.page.shortUrl,i=0===t.src.indexOf("//")?"http:":"",s=[{text:"Facebook",css:"facebook",icon:m.inlineSvg("shareFacebook",["icon"]),url:"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(n+"/sfb#img-"+e)},{text:"Twitter",css:"twitter",icon:m.inlineSvg("shareTwitter",["icon"]),url:"https://twitter.com/intent/tweet?text="+encodeURIComponent(o.page.webTitle)+"&url="+encodeURIComponent(n+"/stw#img-"+e)},{text:"Pinterest",css:"pinterest",icon:m.inlineSvg("sharePinterest",["icon"]),url:encodeURI("http://www.pinterest.com/pin/create/button/?description="+o.page.webTitle+"&url="+n+"&media="+i+t.src)}];return c(p.replace(/^\s+|\s+$/gm,""),{articleType:"gallery",count:this.images.length,index:e,caption:t.caption,credit:t.displayCredit?t.credit:"",blockShortUrl:n,shareButtons:y(s,c.bind(null,v)).join(""),shareButtonsMobile:y(s,c.bind(null,b)).join("")})},_.prototype.initSwipe=function(){var e,n,i,o;t.on(this.$swipeContainer[0],"touchstart",function(t){e=this.swipeContainerWidth*this.swipeThreshold,n=t.touches[0].pageX,i=0}.bind(this)),o=function(t){t.preventDefault(),t.touches.length>1||t.scale&&1!==t.scale||(i=t.touches[0].pageX-n,this.translateContent(this.index,i,20))}.bind(this),t.on(this.$swipeContainer[0],"touchmove",w(o,20,{trailing:!1})),t.on(this.$swipeContainer[0],"touchend",function(){var t;t=Math.abs(i)>e?i>e?1:-1:0,i=0,1===t?this.index>1?this.trigger("prev"):this.trigger("reload"):-1===t&&this.index<this.$slides.length?this.trigger("next"):this.trigger("reload")}.bind(this))},_.prototype.disableHover=function(){this.$lightboxEl.removeClass("gallery-lightbox--hover")},_.prototype.trigger=function(t,e){this.fsm.trigger(t,e)},_.prototype.loadGalleryfromJson=function(t,e){this.index=e,this.galleryJson&&t.id===this.galleryJson.id?this.trigger("open"):this.trigger("loadJson",t)},_.prototype.loadSurroundingImages=function(n,o){var s,r;[-1,0,1].map(function(t){return n+t===0?o-1:(n-1+t)%o}).forEach(function(n){s=this.images[n],r=e(this.$images[n]),r.attr("src")||(r.parent().append(e.create(g)),r.attr("src",s.src),r.attr("srcset",s.srcsets),r.attr("sizes",s.sizes),t.one(r[0],"load",function(){i(".js-loader").remove()}))}.bind(this))},_.prototype.translateContent=function(t,e,n){var i=-1*(t-1)*this.swipeContainerWidth,o=this.$contentEl[0];o.style.webkitTransitionDuration=n+"ms",o.style.mozTransitionDuration=n+"ms",o.style.msTransitionDuration=n+"ms",o.style.transitionDuration=n+"ms",o.style.webkitTransform="translate("+(i+e)+"px,0)translateZ(0)",o.style.mozTransform="translate("+(i+e)+"px,0)",o.style.msTransform="translate("+(i+e)+"px,0)",o.style.transform="translate("+(i+e)+"px,0)translateZ(0)"},_.prototype.states={closed:{enter:function(){this.hide()},leave:function(){this.show(),l.pushUrl({},document.title,"/"+this.galleryJson.id)},events:{open:function(){this.swipe&&this.swipe.slide(this.index,0),this.state="image"},loadJson:function(t){this.galleryJson=t,this.images=t.images,this.$countEl.text(this.images.length);var n=this.images.map(function(t,e){return this.generateImgHTML(t,e+1)}.bind(this)).join("");this.$contentEl.html(n),this.$images=i(".js-gallery-lightbox-img",this.$contentEl[0]),this.showEndslate&&this.loadEndslate(),this.$slides=i(".js-gallery-slide",this.$contentEl[0]),this.useSwipe&&this.initSwipe(),this.galleryJson.images.length<2&&(e([this.nextBtn,this.prevBtn]).hide(),i(".gallery-lightbox__progress",this.lightboxEl).hide()),this.state="image"}}},image:{enter:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.loadSurroundingImages(this.index,this.images.length),this.translateContent(this.index,0,this.useSwipe&&s.isBreakpoint({max:"tablet"})?100:0),l.pushUrl({},document.title,"/"+this.galleryJson.id+"#img-"+this.index,!0),t.on(this.$swipeContainer[0],"click",".js-gallery-content",this.toggleInfo),a.on("window:throttledResize",this.resize),this.$indexEl.text(this.index),u.upgradePictures()},leave:function(){t.off(this.$swipeContainer[0],"click",this.toggleInfo),a.off("window:throttledResize",this.resize)},events:{next:function(){this.pulseButton(this.nextBtn),this.index===this.images.length?this.showEndslate?this.state="endslate":(this.index=1,this.reloadState=!0):(this.index+=1,this.reloadState=!0)},prev:function(){this.pulseButton(this.prevBtn),1===this.index?this.showEndslate?this.state="endslate":(this.index=this.images.length,this.reloadState=!0):(this.index-=1,this.reloadState=!0)},reload:function(){this.reloadState=!0},"toggle-info":function(){this.pulseButton(this.infoBtn),this.$lightboxEl.toggleClass("gallery-lightbox--show-info")},"hide-info":function(){this.pulseButton(this.infoBtn),this.$lightboxEl.removeClass("gallery-lightbox--show-info")},"show-info":function(){this.pulseButton(this.infoBtn),this.$lightboxEl.addClass("gallery-lightbox--show-info")},resize:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.loadSurroundingImages(this.index,this.images.length),this.translateContent(this.index,0,0)},close:function(){this.state="closed"}}},endslate:{enter:function(){this.translateContent(this.$slides.length,0,0),this.index=this.images.length+1,a.on("window:throttledResize",this.resize)},leave:function(){a.off("window:throttledResize",this.resize)},events:{next:function(){this.pulseButton(this.nextBtn),this.index=1,this.state="image"},prev:function(){this.pulseButton(this.prevBtn),this.index=this.images.length,this.state="image"},reload:function(){this.reloadState=!0},resize:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.translateContent(this.$slides.length,0,0)},close:function(){this.state="closed"}}}},_.prototype.show=function(){var n=e(document.body);this.bodyScrollPosition=n.scrollTop(),n.addClass("has-overlay"),this.$lightboxEl.addClass("gallery-lightbox--open"),t.off(document.body,"keydown",this.handleKeyEvents),t.on(document.body,"keydown",this.handleKeyEvents)},_.prototype.close=function(){l.hasHistorySupport?l.back():this.trigger("close"),this.trigger("close")},_.prototype.hide=function(){var n=e(document.body);n.removeClass("has-overlay"),t.off(document.body,"keydown",this.handleKeyEvents),window.setTimeout(function(){this.bodyScrollPosition&&n.scrollTop(this.bodyScrollPosition),this.$lightboxEl.removeClass("gallery-lightbox--open"),u.upgradePictures(),a.emit("ui:images:vh")}.bind(this),1)},_.prototype.pulseButton=function(t){var n=e(t);n.addClass("gallery-lightbox__button-pulse"),window.setTimeout(function(){n.removeClass("gallery-lightbox__button-pulse")},75)},_.prototype.handleKeyEvents=function(t){37===t.keyCode?this.trigger("prev"):39===t.keyCode?this.trigger("next"):38===t.keyCode?this.trigger("show-info"):40===t.keyCode?this.trigger("hide-info"):27===t.keyCode?this.close():73===t.keyCode&&this.trigger("toggle-info")},_.prototype.endslate=new d,_.prototype.loadEndslate=function(){this.endslate.rendered||(this.endslateEl=e.create(f),this.$contentEl.append(this.endslateEl),this.endslate.componentClass="gallery-lightbox__endslate",this.endslate.endpoint="/gallery/most-viewed.json",this.endslate.ready=function(){a.emit("page:new-content")},this.endslate.prerender=function(){e(this.elem).addClass(this.componentClass)},this.endslate.fetch(n(".js-gallery-endslate",this.endslateEl),"html"))},{init:x,GalleryLightbox:_}}.apply(e,i))&&(t.exports=o)},430:function(t,e,n){var i,o;i=[n(23),n(15),n(4),n(83)],void 0!==(o=function(t,e,n,i){return{init:function(){var o,s=document.body.querySelector(".js-id-send-validation-email");s&&(o=e(s),t.on(s,"click",function(t){t.preventDefault(),i.isUserLoggedIn()&&i.sendValidationEmail().then(function(t){"error"===t.status?(n.emit("module:identity:validation-email:fail"),o.innerHTML="An error occured, please click here to try again."):(n.emit("module:identity:validation-email:success"),o.replaceWith("<p>Sent. Please check your email and follow the link.</p>"))},function(){n.emit("module:identity:validation-email:fail"),o.innerHTML="An error occured, please click here to try again."})}))}}}.apply(e,i))&&(t.exports=o)},453:function(t,e,n){var i,o;i=[n(140),n(263)],void 0!==(o=function(t,e){function n(){return e(t(arguments,!0,!0))}return n}.apply(e,i))&&(t.exports=o)},476:function(t,e,n){var i,o;i=[n(640),n(22),n(0),n(4),n(132),n(478),n(542),n(869),n(883),n(448),n(885)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d){function u(){if(n.switches.openCta&&n.page.commentable){var t=new a(i,{discussionKey:n.page.shortUrlId||""});e.create('<div class="open-cta"></div>').each(function(e){t.fetch(e),n.page.isLiveBlog||n.page.isMinuteArticle||l.addComponent(e)})}}function m(){e(".fenced").each(function(e){t.render(e)})}function p(){r.init(),r.enhanceTweets()}return function(){o.catchErrorsWithContext([["trail-a11y",s.shouldHideFlashingElements],["trail-article",u],["trail-fence",m],["trail-twitter",p],["trail-sharing",d.init],["trail-last-modified",c]])}}.apply(e,i))&&(t.exports=o)},478:function(t,e,n){var i,o;i=[n(20),n(424),n(22)],void 0!==(o=function(t,e,n){function i(i){e.isOn("flashing-elements")?i&&i():t.write(function(){n("body").addClass("disable-flashing-elements"),i&&i()})}return{shouldHideFlashingElements:i}}.apply(e,i))&&(t.exports=o)},479:function(t,e,n){var i,o;i=[n(15),n(22),n(4),n(16),n(0),n(83),n(41)],void 0!==(o=function(t,e,n,i,o,s,r){function a(t,e){var n=i({nonInteraction:!0},e||{});window.ga(l+".send","event","element view","onpage item",t,n)}var c={};c.seen=!1;var l=o.googleAnalytics.trackers.editorial;return c.jumpedToComments=function(){c.seen||(c.seen=!0)},c.commentPermalink=function(){c.seen||(c.seen=!0)},c.scrolledToComments=function(){c.seen||(a("scroll to comments"),c.seen=!0)},c.areCommentsSeen=function(){var t=function(){!c.seen&&c.areCommentsVisible()&&(c.scrolledToComments(),n.off("window:throttledScroll",r(t,200)))};c.seen||n.on("window:throttledScroll",r(t,200))},c.areCommentsVisible=function(){var n=e("#comments").offset(),i=window.pageYOffset,o=t.viewport().height;return n.top-o/2<i&&n.top+n.height-o/3>i},{init:function(){n.on("discussion:seen:comment-permalink",c.commentPermalink.bind(c)),n.on("discussion:seen:comments-anchor",c.jumpedToComments.bind(c)),n.on("discussion:seen:comments-scrolled-to",c.scrolledToComments.bind(c)),c.areCommentsSeen()}}}.apply(e,i))&&(t.exports=o)},481:function(t,e,n){var i,o;i=[n(23),n(15),n(5),n(22),n(0),n(29),n(4),n(61),n(235),n(62),n(38),n(397),n(427),n(485),n(398),n(131),n(189)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u,m,p,h,f,g){"use strict";var v=function(){return null===f.get("discussion.enableRelativeTimestamps")||f.get("discussion.enableRelativeTimestamps")},b=function(t){this.setOptions(t)};return d.define(b),b.prototype.componentClass="d-comments",b.prototype.classes={comments:"d-thread--top-level",topLevelComment:"d-comment--top-level",reply:"d-comment--response",showReplies:"d-show-more-replies",showRepliesButton:"d-show-more-replies__button",newComments:"js-new-comments",comment:"d-comment",commentReply:"d-comment__action--reply",commentPick:"d-comment__action--pick",commentStaff:"d-comment--staff",commentBody:"d-comment__body",commentTimestampJs:"js-timestamp",commentReport:"js-report-comment"},b.prototype.defaultOptions={discussionId:null,showRepliesCount:3,commentId:null,order:"newest",threading:"collapsed"},b.prototype.comments=null,b.prototype.topLevelComments=null,b.prototype.user=null,b.prototype.ready=function(){this.topLevelComments=n(this.getClass("topLevelComment"),this.elem),this.comments=n(this.getClass("comment"),this.elem),this.on("click",this.getClass("showRepliesButton"),this.getMoreReplies),this.on("click",this.getClass("commentReport"),this.reportComment),v()&&(window.setInterval(function(){this.relativeDates()}.bind(this),6e4),this.relativeDates()),this.emit("ready"),this.on("click",".js-report-comment-close",function(){document.querySelector(".js-report-comment-form").setAttribute("hidden","")})},b.prototype.handlePickClick=function(t){t.preventDefault();var e=t.target.getAttribute("data-comment-id"),n=i(t.target);("true"===n[0].getAttribute("data-comment-highlighted")?this.unPickComment.bind(this):this.pickComment.bind(this))(e,n).fail(function(e){var n=e.response.length>0?JSON.parse(e.response).message:e.statusText;i(t.target).text(n)})},b.prototype.pickComment=function(t,e){var o=this,s=n("#comment-"+t,this.elem);return u.pickComment(t).then(function(){i(o.getClass("commentPick"),s).removeClass("u-h"),e.text("Unpick"),s.setAttribute("data-comment-highlighted",!0)})},b.prototype.unPickComment=function(t,e){var o=this,s=n("#comment-"+t);return u.unPickComment(t).then(function(){i(o.getClass("commentPick"),s).addClass("u-h"),e.text("Pick"),s.setAttribute("data-comment-highlighted",!1)})},b.prototype.fetchComments=function(t){t=t||{};var e="/discussion/"+(t.comment?"comment-context/"+t.comment:this.options.discussionId)+".json",n=t.order||this.options.order;"recommendations"===n&&(n="mostRecommended");var i={orderBy:n,pageSize:t.pagesize||this.options.pagesize,displayThreaded:"unthreaded"!==this.options.threading,commentsClosed:t.commentsClosed};t.page&&(i.page=t.page),t.comment||"collapsed"!==this.options.threading||(i.maxResponses=3);var o,r={mode:"cors"};return this.isAllPageSizeActive()?o=new p({discussionId:this.options.discussionId,orderBy:i.orderBy,displayThreaded:i.displayThreaded,maxResponses:i.maxResponses,commentsClosed:i.commentsClosed}).loadAllComments().catch(function(){return this.wholeDiscussionErrors=!0,i.pageSize=100,s(e+"?"+l.constructQuery(i),r)}.bind(this)):("All"===i.pageSize&&(i.pageSize=100),o=s(e+"?"+l.constructQuery(i),r)),o.then(this.renderComments.bind(this))},b.prototype.renderComments=function(t){var i=e.create(t.commentsHtml),o=n(this.getClass("comment"),i);e(this.elem).empty().append(i),this.addMoreRepliesButtons(o),this.postedCommentEl=t.postedCommentHtml,v()&&this.relativeDates(),this.emit("rendered",t.paginationHtml),r.emit("modules:comments:renderComments:rendered")},b.prototype.showHiddenComments=function(t){t&&t.preventDefault(),this.emit("first-load"),i(".js-discussion-main-comments").css("display","block"),v()&&this.relativeDates()},b.prototype.addMoreRepliesButtons=function(t){t=t||this.topLevelComments,t.forEach(function(t){var e=parseInt(t.getAttribute("data-comment-replies"),10),o=n(this.getClass("reply"),t);if(o.length<e){var s=e-o.length,r=i.create('<button class="u-button-reset button button--show-more button--small button--tone-news d-show-more-replies__button">'+g.inlineSvg("plus",["icon"])+"Show "+s+" more "+(1===s?"reply":"replies")+"</button>").attr({"data-link-name":"Show more replies","data-is-ajax":"","data-comment-id":t.getAttribute("data-comment-id")}).data("source-comment",t);i.create('<li class="'+this.getClass("showReplies",!0)+'"></li>').append(r).appendTo(i(".d-thread--responses",t))}}.bind(this))},b.prototype.getMoreReplies=function(t){t.preventDefault();var o=i.ancestor(t.currentTarget,this.getClass("showReplies").slice(1));o.innerHTML="Loading…";var r=e(t.target).data("source-comment"),c=t.currentTarget.getAttribute("data-comment-id");s("/discussion/comment/"+c+".json?displayThreaded=true",{mode:"cors"}).then(function(t){var i=e.create(t.html),s=n(this.getClass("reply"),i);s=s.slice(this.options.showRepliesCount),e(n(".d-thread--responses",r)).append(s),e(o).addClass("u-h"),this.emit("untruncate-thread"),v()&&this.relativeDates()}.bind(this)).catch(function(t){a(t,{feature:"comments-more-replies"})})},b.prototype.isReadOnly=function(){return"true"===this.elem.getAttribute("data-read-only")},b.prototype.addComment=function(t,o,s){var r,a,c,l,d,u={username:"d-comment__author",timestamp:"js-timestamp",body:"d-comment__body",report:"d-comment__action--report",avatar:"d-comment__avatar"},m={username:this.user.displayName,timestamp:"Just now",body:"<p>"+t.body.replace(/\n+/g,"</p><p>")+"</p>",report:{href:"http://discussion.theguardian.com/components/report-abuse/"+t.id},avatar:{src:this.user.avatar}},p=e.create(this.postedCommentEl)[0],h=e(p);h.addClass("d-comment--new");for(r in u)if(u.hasOwnProperty(r))if(c=u[r],a=m[r],l=n("."+c,p)[0],"string"==typeof a)l.innerHTML=a;else for(d in a)l.setAttribute(d,a[d]);p.id="comment-"+t.id,this.user&&!this.user.isStaff&&h.addClass(this.getClass("commentStaff",!0)),s?(h.removeClass(this.getClass("topLevelComment",!0)),h.addClass(this.getClass("reply",!0)),e(s).append(h)):i(this.getClass("newComments"),this.elem).prepend(p),window.location.replace("#comment-"+t.id)},b.prototype.replyToComment=function(t){t.preventDefault();var o,s,r=t.currentTarget,a=r.getAttribute("data-comment-id"),c=this;if(document.getElementById("reply-to-"+a))return void document.getElementById("reply-to-"+a).focus();i(".d-comment-box--response").remove();var l=n("#comment-"+a)[0],d=l.getAttribute("data-comment-author"),u=l.getAttribute("data-comment-author-id"),p=e(l),h=n(this.getClass("commentBody"),l)[0].innerHTML,f=n(this.getClass("commentTimestampJs"),l)[0].innerHTML,g=new m({discussionId:this.options.discussionId,premod:this.user.privateFields.isPremoderated,state:"response",replyTo:{commentId:a,author:d,authorId:u,body:h,timestamp:f},focus:!0});o=p.hasClass(this.getClass("topLevelComment",!0))?p[0]:p.parent().parent()[0],s=n(this.getClass("showReplies"),o),s.length>0&&!e(s).hasClass("u-h")&&s[0].click(),g.render(o),g.on("post:success",function(t){var i=n(".d-thread--responses",o)[0];i||(i=e.create('<ul class="d-thread d-thread--responses"></ul>')[0],e(o).append(i)),this.destroy(),c.addComment(t,!1,i)})},b.prototype.reportComment=function(e){e.preventDefault();var n=this,o=e.currentTarget.getAttribute("data-comment-id");i(".js-report-comment-form").first().each(function(e){e.removeAttribute("hidden"),t.one(e,"submit",function(t){t.preventDefault();var i=e.elements.category,s=e.elements.comment.value;"0"!==i.value&&u.reportComment(o,{emailAddress:e.elements.email.value,categoryId:i.value,reason:s}).then(n.reportCommentSuccess.bind(n,e),n.reportCommentFailure.bind(n))})}).appendTo(i("#comment-"+o+" .js-report-comment-container").first())},b.prototype.reportCommentSuccess=function(t){t.setAttribute("hidden","")},b.prototype.reportCommentFailure=function(){document.querySelector(".js-discussion__report-comment-error").removeAttribute("hidden"),document.querySelector(".d-report-comment__close").classList.add("d-report-comment__close--error")},b.prototype.addUser=function(t){var e=this;this.user=t,this.user&&this.user.badge&&(this.user.isStaff=this.user.badge.some(function(t){return"Staff"===t.name})),this.isReadOnly()||this.user&&this.user.privateFields.canPostComment&&(i(this.getClass("commentReply")).attr("href","#"),this.on("click",this.getClass("commentReply"),this.replyToComment),this.on("click",this.getClass("commentPick"),this.handlePickClick)),r.on("user:username:updated",function(t){e.user&&(e.user.displayName=t)})},b.prototype.relativeDates=function(){v()&&h.init()},b.prototype.isAllPageSizeActive=function(){return o.switches.discussionAllPageSize&&"All"===this.options.pagesize&&!this.wholeDiscussionErrors},b.prototype.shouldShowPageSizeMessage=function(){return o.switches.discussionAllPageSize&&"All"===this.options.pagesize&&this.wholeDiscussionErrors},b}.apply(e,i))&&(t.exports=o)},482:function(t,e,n){var i,o;i=[n(20),n(432),n(4),n(61),n(0),n(134)],void 0!==(o=function(t,e,n,i,o,s){function r(r,a){function c(t){t.on("error",function(t,e){i(e,{feature:"discussion-"+t},!1)}),t.once("comment-count",function(t){if(0===t)r.setState("empty");else for(var e=document.getElementsByClassName("js_commentcount_actualvalue"),i=0,o=e.length;i<o;i+=1)l(e[i],t);n.emit("comments-count-loaded")})}function l(n,i){t.write(function(){n.textContent=e.integerCommas(i)})}function d(t){i(t,{feature:"discussion"})}function u(t){t(a).then(c).catch(d)}return s.loadScript(o.page.discussionFrontendUrl).then(function(){u(window.guardian.app.discussion)}).catch(d)}return{load:r}}.apply(e,i))&&(t.exports=o)},483:function(t,e,n){var i,o;i=[n(23),n(15),n(5),n(22),n(31),n(0),n(14),n(4),n(235),n(50),n(29),n(479),n(396),n(38),n(397),n(427),n(481),n(482),n(484),n(188),n(83),n(131),n(267)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u,m,p,h,f,g,v,b,y,w,C,_){var x=function(){m.begin("discussion")};return p.define(x),x.prototype.classes={},x.prototype.componentClass="discussion",x.prototype.comments=null,x.prototype.user=null,x.prototype.username=null,x.prototype.initTopComments=function(){return this.on("click",".js-jump-to-comment",function(t){t.preventDefault();var n=e(t.currentTarget).data("comment-id");this.gotoComment(n)}),d("/discussion/top-comments/"+this.getDiscussionId()+".json?commentsClosed="+this.getDiscussionClosed(),{mode:"cors"}).then(function(t){this.$topCommentsContainer.html(t.html),this.topCommentCount=n(".d-top-comment",this.$topCommentsContainer[0]).length,0!==this.topCommentCount&&(i(".js-discussion-comment-box--bottom").removeClass("discussion__comment-box--bottom--hidden"),this.setState("has-top-comments"))}.bind(this)).catch(this.logError.bind(this,"Top comments"))},x.prototype.initMainComments=function(){var t=this,o=this.getCommentIdFromHash(),c=C.get("discussion.order")||(this.getDiscussionClosed()?"oldest":"newest"),l=C.get("discussion.threading")||"collapsed",d=r.isBreakpoint({min:"tablet"})?25:10;this.comments=new g({discussionId:this.getDiscussionId(),order:c,pagesize:d,threading:l}),this.comments.attachTo(n(".js-discussion-main-comments")[0]),this.comments.on("untruncate-thread",this.removeTruncation.bind(this)),this.on("click,",".js-discussion-author-link",this.removeTruncation.bind(this)),this.on("click",".js-discussion-change-page, .js-discussion-show-button",function(){a.emit("discussion:comments:get-more-replies"),t.removeTruncation()}),this.comments.on("rendered",function(t){var o=e.create(t),s=n(".js-discussion-toolbar",this.elem)[0],r=i(".js-discussion-pagination",s).empty();this.comments.isAllPageSizeActive()||r.html(o)}.bind(this)),this.setState("loading"),this.on("user:loaded",function(){if(this.initState(),this.renderCommentBar(),this.user){this.comments.addUser(this.user);var t=C.get("discussion.pagesize"),e=d;_(t)?e=t:"All"===t&&(e=s.switches.discussionAllPageSize?"All":100),this.initPageSizeDropdown(e),s.switches.discussionPageSize&&r.isBreakpoint({min:"tablet"})&&(this.comments.options.pagesize=e),this.user.isStaff&&(this.removeState("not-staff"),this.setState("is-staff"))}var n=!o&&"#comments"!==window.location.hash;this.loadComments({comment:o,shouldTruncate:n}).catch(this.logError.bind(this,"Comments"))}),this.getUser()},x.prototype.logError=function(t,e){var n=t+" failed to load: ",i=e.request||{};"Request is aborted: timeout"===e.message?n+="XHR timeout":e.message?n+=e.message:n+="status"in i?i.status:"",o.captureMessage(n,{tags:{contentType:"comments",discussionId:this.getDiscussionId(),status:"status"in i?i.status:"",readyState:"readyState"in i?i.readyState:"",response:"response"in i?i.response:"",statusText:"status"in i?i.statusText:""}})},x.prototype.initPageSizeDropdown=function(o){var s=i(".js-comment-pagesize");s.text(o),this.on("click",".js-comment-pagesize-dropdown .popup__action",function(i){t.fire(n(".js-comment-pagesize-dropdown [data-toggle]")[0],"click");var o=e(i.currentTarget).data("pagesize");this.comments.options.pagesize=o,s.text(o),C.set("discussion.pagesize",o),this.loadComments({page:1})})},x.prototype.initToolbar=function(){var o=i(".js-comment-order");o.text(this.comments.options.order),this.on("click",".js-comment-order-dropdown .popup__action",function(i){t.fire(n(".js-comment-order-dropdown [data-toggle]")[0],"click"),this.comments.options.order=e(i.currentTarget).data("order"),o.text(this.comments.options.order),C.set("discussion.order",this.comments.options.order),this.loadComments({page:1})});var r=i(".js-comment-threading");if(r.text(this.comments.options.threading),this.on("click",".js-comment-threading-dropdown .popup__action",function(i){t.fire(n(".js-comment-threading-dropdown [data-toggle]")[0],"click"),this.comments.options.threading=e(i.currentTarget).data("threading"),r.text(this.comments.options.threading),C.set("discussion.threading",this.comments.options.threading),this.loadComments()}),"crosswords"===s.page.section){var a=i(".js-timestamps"),c=function(t){a.text(t?"Relative":"Absolute")};c(void 0);var l=null===C.get("discussion.enableRelativeTimestamps")||C.get("discussion.enableRelativeTimestamps");c(l),this.on("click",".js-timestamps-dropdown .popup__action",function(i){t.fire(n(".js-timestamps-dropdown [data-toggle]")[0],"click");var o=e(i.currentTarget).data("timestamp"),s="relative"===o;c(s),C.set("discussion.enableRelativeTimestamps",s),this.loadComments()})}},x.prototype.initRecommend=function(){this.on("click",".js-recommend-comment",function(t){b.handle(t.currentTarget,this.elem,this.user,h,s.switches.discussionAllowAnonymousRecommendsSwitch)}),this.on("click",".js-rec-tooltip-close",function(){b.closeTooltip()})},x.prototype.ready=function(){this.$topCommentsContainer=i(".js-discussion-top-comments"),this.initTopComments(),this.initMainComments(),this.initToolbar(),this.renderCommentCount(),this.initPagination(),this.initRecommend(),u.init(),"#comments"===window.location.hash?a.emit("discussion:seen:comments-anchor"):this.getCommentIdFromHash()&&a.emit("discussion:seen:comment-permalink"),a.on("discussion:commentbox:post:success",this.removeState.bind(this,"empty")),a.on("module:clickstream:click",function(t){t&&"hash"in t.target&&"#comments"===t.target.hash&&this.removeTruncation()}.bind(this)),m.end("discussion")},x.prototype.getUser=function(){var t=this;w.getUserFromCookie()?h.getUser().then(function(e){t.user=e.userProfile,w.getUserFromApiWithRefreshedCookie().then(function(e){e.user.publicFields.username&&(t.username=e.user.publicFields.username),t.emit("user:loaded")})}.bind(t)):this.emit("user:loaded")},x.prototype.isCommentable=function(){return this.user&&this.user.privateFields&&this.user.privateFields.canPostComment&&!this.comments.isReadOnly()&&!this.getDiscussionClosed()},x.prototype.initState=function(){this.getDiscussionClosed()?this.setState("closed"):this.comments.isReadOnly()?this.setState("readonly"):w.getUserFromCookie()&&this.user&&this.user.privateFields&&!this.user.privateFields.canPostComment?this.setState("banned"):this.setState("open")},x.prototype.renderCommentBar=function(){this.isCommentable()&&(this.renderCommentBox(n(".js-discussion-comment-box--top")[0]),this.renderCommentBox(n(".js-discussion-comment-box--bottom")[0]))},x.prototype.commentPosted=function(){this.removeState("truncated"),this.comments.addComment.apply(this.comments,arguments)},x.prototype.renderCommentBox=function(t){return new f({discussionId:this.getDiscussionId(),premod:this.user.privateFields.isPremoderated,newCommenter:!this.user.privateFields.hasCommented,hasUsername:null!==this.username,shouldRenderMainAvatar:!1}).render(t).on("post:success",this.commentPosted.bind(this))},x.prototype.getDiscussionId=function(){return this.elem.getAttribute("data-discussion-key")},x.prototype.getDiscussionClosed=function(){return"true"===this.elem.getAttribute("data-discussion-closed")},x.prototype.renderCommentCount=function(){return v.load(this,{apiHost:s.page.discussionApiUrl,avatarImagesHost:s.page.avatarImagesUrl,closed:this.getDiscussionClosed(),discussionId:this.getDiscussionId(),element:document.getElementsByClassName("js-discussion-external-frontend")[0],userFromCookie:!!w.getUserFromCookie(),profileUrl:s.page.idUrl,profileClientId:s.switches.registerWithPhone?"comments":"",Promise:Promise})},x.prototype.getCommentIdFromHash=function(){var t=/#comment-(\d+)/;return t.exec(window.location.hash)?parseInt(t.exec(window.location.hash)[1],10):null},x.prototype.setCommentHash=function(t){window.location.replace("#comment-"+t)},x.prototype.initPagination=function(){this.on("click",".js-discussion-change-page",function(t){t.preventDefault();var e=parseInt(t.currentTarget.getAttribute("data-page"),10);this.setState("loading"),this.gotoPage(e)})},x.prototype.gotoComment=function(t,e){var s=i("#comment-"+t,this.elem),r=this;if(s.length>0){"none"===i(".js-discussion-main-comments").css("display")?l.write(function(){r.comments.showHiddenComments(),r.removeState("truncated");var t=i(".d-discussion__show-all-comments");t.length&&t.addClass("u-h")}).then(function(){r.setCommentHash(t)}):r.setCommentHash(t)}else e?(c.scrollToElement(n(".js-discussion-toolbar"),100),l.write(function(){i(".js-discussion-main-comments").prepend('<div class="d-discussion__message d-discussion__message--error">The comment you requested could not be found.</div>')}),o.captureMessage("Comment doesn't exist in response",{level:"error",extra:{commentId:t}})):r.loadComments({comment:t})},x.prototype.gotoPage=function(t){c.scrollToElement(n(".js-discussion-toolbar"),100),this.comments.relativeDates(),this.loadComments({page:t})},x.prototype.loadComments=function(t){return this.setState("loading"),t=t||{},t&&t.shouldTruncate&&this.comments.isAllPageSizeActive()&&(t.pageSize=10),t.commentsClosed=this.getDiscussionClosed(),this.comments.fetchComments(t).then(function(){this.removeState("loading"),t&&t.shouldTruncate?this.setState("truncated"):this.removeState("truncated"),this.comments.shouldShowPageSizeMessage()?this.setState("pagesize-msg-show"):this.removeState("pagesize-msg-show"),t.comment&&this.gotoComment(t.comment,!0)}.bind(this))},x.prototype.removeTruncation=function(){this.comments.isAllPageSizeActive()?this.loadComments():this.removeState("truncated")},x}.apply(e,i))&&(t.exports=o)},484:function(t,e,n){var i,o;i=[n(16),n(50),n(61),n(62)],void 0!==(o=function(t,e,n,i){function o(t,e,i,o,d){if(!d&&!i)return t.setAttribute("data-link-name","Recommend comment anonymous"),l(t);if((d||i)&&s(e)){var u=t.getAttribute("data-comment-id");return Promise.all([r(t),o.recommendComment(u)]).then(function(){return c(t)}).catch(function(e){return a(t).then(function(){n(e,{feature:"comments-recommend"})})})}}function s(t){return!!t.querySelector(".d-discussion--recommendations-open")}function r(t){return e.write(function(){t.classList.remove(m),t.classList.add("d-comment__recommend--clicked")})}function a(t){return e.write(function(){t.classList.add(m),t.classList.remove("d-comment__recommend--clicked")})}function c(t){return e.write(function(){t.classList.add("d-comment__recommend--recommended")})}function l(t){var n=document.querySelector("."+p),i=n.querySelectorAll(".js-rec-tooltip-link");return e.write(function(){d(i,t.getAttribute("data-comment-url")),n.removeAttribute("hidden"),t.appendChild(n)})}function d(e,n){for(var o=0,s=e.length;o<s;o+=1){var r=e[o].getAttribute("href"),a=r.split("?")[0],c=i.getUrlVars(r.split("?")[1]||"&");e[o].setAttribute("href",a+"?"+i.constructQuery(t(c,{returnUrl:n})))}}function u(){return e.write(function(){document.querySelector("."+p).setAttribute("hidden","")})}var m="js-recommend-comment",p="js-rec-tooltip";return{handle:o,closeTooltip:u}}.apply(e,i))&&(t.exports=o)},485:function(t,e,n){var i,o;i=[n(15),n(5),n(22),n(29),n(62),n(414)],void 0!==(o=function(t,e,n,i,o,s){function r(t,e){return new Promise(function(n){function i(){r--,s.length?o(s.shift()):r||n()}function o(e){r++,t.call(null,e).then(i,i)}var s=e,r=0;if(!e||!e.length)return void n();e.splice(0,c).forEach(o)})}function a(t){this.discussionId=t.discussionId,this.discussion=[],this.params={orderBy:t.orderBy,displayThreaded:t.displayThreaded,maxResponses:t.maxResponses,commentsClosed:t.commentsClosed}}var c=3;return a.prototype.firstPageLoaded=function(e){if(this.storeCommentPage(e,1),this.discussionContainer=t.create(e.commentsHtml),this.commentsThread=n(".d-thread--comments",this.discussionContainer).empty(),this.postedCommentHtml=e.postedCommentHtml,this.lastPage=e.lastPage,e.commentCount>1e3)throw new Error("Discussion comment count too large");return s(2,this.lastPage+1)},a.prototype.storeCommentPage=function(e,i){var o=n(".d-thread--comments",t.create(e.commentsHtml)),s=n(".d-comment--top-level",o);"newest"===this.params.orderBy&&(s=s.map(function(t){return t}).reverse()),this.discussion[i]=s},a.prototype.loadPage=function(t){var e={orderBy:"oldest",page:t,pageSize:50,displayThreaded:this.params.displayThreaded,commentsClosed:this.params.commentsClosed};this.params.maxResponses&&(e.maxResponses=this.params.maxResponses);var n="/discussion/"+this.discussionId+".json?"+o.constructQuery(e);return i(n,{mode:"cors"})},a.prototype.loadPageAndStore=function(t){return this.loadPage(t).then(function(e){this.storeCommentPage(e,t)}.bind(this))},a.prototype.loadRemainingPages=function(t){return r(this.loadPageAndStore.bind(this),t)},a.prototype.makeDiscussionResponseObject=function(){return"newest"===this.params.orderBy&&this.discussion.reverse(),this.discussion.reduce(function(t,e){return t.append(e),t},this.commentsThread),{paginationHtml:"",postedCommentHtml:this.postedCommentHtml,commentsHtml:this.discussionContainer.html(),lastPage:this.lastPage}},a.prototype.loadAllComments=function(){return this.loadPage(1).then(this.firstPageLoaded.bind(this)).then(this.loadRemainingPages.bind(this)).then(this.makeDiscussionResponseObject.bind(this))},a}.apply(e,i))&&(t.exports=o)},486:function(t,e,n){var i,o;i=[n(0),n(4),n(396),n(38),n(453)],void 0!==(o=function(t,e,n,i,o){function s(e){n.begin("series-content"),this.context=e,this.endpoint="/series/"+r()+".json?shortUrl="+encodeURIComponent(t.page.shortUrl),this.fetch(this.context,"html")}var r=function(){var e=t.page.blogIds.split(",").concat([t.page.seriesId]);return o(t.page.nonKeywordTagIds.split(","),e).shift()};return i.define(s),s.prototype.ready=function(){n.end("series-content"),e.emit("modules:onward:loaded"),e.emit("page:new-content"),e.emit("ui:images:upgradePictures")},s.prototype.error=function(){n.error("series-content")},s}.apply(e,i))&&(t.exports=o)},541:function(t,e,n){var i,o;i=[n(20),n(5),n(22),n(0),n(14),n(29),n(4),n(61),n(12),n(50),n(243),n(335),n(686),n(232),n(405)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u,m,p){function h(t){return l.read(function(){return t.getBoundingClientRect().top>(window.innerHeight||document.documentElement.clientHeight)})}function f(e){function i(i,o){if(i)return t.write(function(){n(e).html(o.html).removeClass("element-rich-link--not-upgraded").addClass("element-rich-link--upgraded"),u.upgradePictures(e),n(".submeta-container--break").removeClass("submeta-container--break"),r.emit("rich-link:loaded",e)})}var c=n("a",e).attr("href"),l=c.match(/(?:^https?:\/\/(?:www\.|m\.code\.dev-)theguardian\.com)?(\/.*)/),d=o.isBreakpoint({max:"mobileLandscape"});return l&&l[1]?s("/embed/card"+l[1]+".json",{mode:"cors"}).then(function(t){t.html&&(d?h(e).then(function(e){i(e,t)}):i(!0,t))}).catch(function(t){a(t,{feature:"rich-links"})}):Promise.resolve(null)}function g(){return{bodySelector:".js-article__body",slotSelector:" > p",minAbove:200,minBelow:250,clearContentMeta:50,selectors:{" > h2":{minAbove:"mobile"===o.getBreakpoint()?20:0,minBelow:200}," > *:not(p):not(h2):not(blockquote)":{minAbove:35,minBelow:300}," .ad-slot":{minAbove:150,minBelow:200}," .element-rich-link":{minAbove:500,minBelow:500}}}}function v(){var t,e=n(".element-rich-link a").map(function(t){return n(t).attr("href")}),o=function(t){return p(i.page.richLink,t)},s=e.some(o),r=i.page.shouldHideAdverts||!i.page.showRelatedContent;return!i.page.richLink||-1!==i.page.richLink.indexOf(i.page.pageId)||r||s?Promise.resolve(null):d.fillSpace(g(),function(e){return t=n.create(c(m,{href:i.page.richLink})),t.insertBefore(e[0]),t[0]},{waitForAds:!0}).then(function(e){return e?Promise.resolve(f(t[0])):Promise.resolve(null)})}function b(){n(".element-rich-link--not-upgraded").each(f)}return{upgradeRichLinks:b,insertTagRichLink:v,getSpacefinderRules:g}}.apply(e,i))&&(t.exports=o)},542:function(t,e,n){var i,o;i=[n(15),n(5),n(20),n(22),n(0),n(14),n(4),n(41)],void 0!==(o=function(t,e,n,i,o,s,r,a){function c(){r.on("window:throttledScroll",a(l,200))}function l(){if(("mobile"!==s.getBreakpoint()||o.page.isMinuteArticle)&&o.switches.enhanceTweets){var r=e("blockquote.js-tweet"),a=t.viewport().height,c=window.pageYOffset;r.forEach(function(e){var o=t(e),s=o.offset();c+2.5*a>s.top&&c<s.top+s.height&&n.write(function(){i(e).removeClass("js-tweet").addClass("twitter-tweet"),d()})})}}function d(){var t,n=e("blockquote.twitter-tweet"),o=e("#twitter-widget");n.length>0&&(0===o.length&&(t=document.createElement("script"),t.id="twitter-widget",t.async=!0,t.src="//platform.twitter.com/widgets.js",i(document.body).append(t)),"undefined"!=typeof twttr&&"widgets"in twttr&&"load"in twttr.widgets&&twttr.widgets.load(u))}var u=e(".js-liveblog-body, .js-article__body, .js-article__body--minute-article");return{init:c,enhanceTweets:l}}.apply(e,i))&&(t.exports=o)},560:function(t,e,n){var i,o;i=[e,n(0),n(14),n(4),n(541),n(849),n(876),n(398),n(476),n(413),n(800),n(132)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u){"use strict";function m(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.notificationsCondition=t.init=void 0;var p=m(e),h=m(n),f=m(i),g=m(o),v=m(s),b=m(r),y=m(a),w=m(c),C=m(l),_=m(d),x=function(){!h.default.isBreakpoint({min:"desktop"})||p.default.page.keywordIds.includes("football/football")||p.default.page.keywordIds.includes("sport/rugby-union")||new v.default({element:document.querySelector(".js-live-blog__sticky-components-container"),topMarker:document.querySelector(".js-top-marker"),bottomMarker:document.querySelector(".js-bottom-marker"),containerElement:document.querySelector(".js-live-blog__sticky-components")})},k=function(){p.default.page.isLive&&(0,b.default)()},S=function(){var t=y.default;window.setInterval(function(){t.init()},6e4)},T=function(){return p.default.switches.liveBlogChromeNotificationsProd&&!h.default.isIOS()&&("https:"===window.location.protocol||"#force-sw"===window.location.hash)&&"Chrome"===h.default.getUserAgent.browser&&p.default.page.isLive},E=function(){T()&&_.default.init()},j=function(){(0,u.catchErrorsWithContext)([["lb-autoupdate",k],["lb-timeline",x],["lb-timestamp",S],["lb-notifications",E],["lb-richlinks",g.default.upgradeRichLinks]]),(0,C.default)(),(0,w.default)(),(0,u.catchErrorsWithContext)([["lb-ready",function(){f.default.emit("page:liveblog:ready")}]])};t.init=j,t.notificationsCondition=T}.apply(e,i))&&(t.exports=o)},567:function(t,e,n){var i,o;i=[t,e,n(22),n(0),n(4),n(50),n(433),n(123),n(434)],void 0!==(o=function(t,e,n,i,o,s,r,a,c){"use strict";function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var d=l(n),u=l(i),m=l(o),p=l(s),h=l(c),f=function(){var t=(0,d.default)(".js-discussion__ad-slot");if(!a.commercialFeatures.commentAdverts||!t.length)return!1;m.default.once("modules:comments:renderComments:rendered",function(){var e=(0,d.default)(".js-comments .content__main-column");p.default.read(function(){return e.dim().height}).then(function(n){if(!(n<280)){var i=(0,h.default)("comments",{classes:"mpu-banner-ad"});p.default.write(function(){return e.addClass("discussion__ad-wrapper"),u.default.page.isLiveBlog||u.default.page.isMinuteArticle||e.addClass("discussion__ad-wrapper-wider"),t.append(i),i}).then(function(t){return(0,r.addSlot)(t,!1)})}})})};e.default=f,t.exports=e.default}.apply(e,i))&&(t.exports=o)},609:function(t,e,n){var i,o;i=[e,n(20),n(61),n(22),n(29),n(0),n(432),n(12),n(189),n(690),n(689)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d){"use strict";function u(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadShareCounts=void 0;var m=u(e),p=u(n),h=u(i),f=u(o),g=u(s),v=u(a),b=u(l),y=u(d),w=(0,h.default)(".js-sharecount"),C={facebook:"n/a"},_=0,x=void 0,k=void 0,S=function(t){if(0!==t){_+=t;var e=parseInt(_.toFixed(0),10),n=(0,r.integerCommas)(e),i=e>1e4?Math.round(e/1e3)+"k":e;m.default.write(function(){x.text(n),k.text(i)})}},T=function(){w.attr("title",(0,v.default)("Facebook: <%=facebook%>",C))},E=function(t){var e=(0,c.inlineSvg)("share"),n=w.hasClass("js-sharecount-immersive")?y.default:b.default,i=(0,v.default)(n,{icon:e});w.removeClass("u-h").html(i).css("display",""),k=(0,h.default)(".sharecount__value--short",w[0]),x=(0,h.default)(".sharecount__value--full",w[0]),S(t)},j=function(){var t=g.default.page.ajaxUrl+"/sharecount/"+g.default.page.pageId+".json";(0,f.default)(t,{mode:"cors"}).then(function(t){var e=t.share_count||0;C.facebook=e,E(e),T()})},I=function(){if(g.default.switches.serverShareCounts&&w.length&&!g.default.page.isPreview)try{j()}catch(t){(0,p.default)(new Error("Error retrieving share counts ("+t.message+")"),{feature:"share-count"},!1)}};t.loadShareCounts=I}.apply(e,i))&&(t.exports=o)},640:function(t,e,n){var i;void 0!==(i=function(){function t(e,n,i,o){o=o||0,e(),n>0&&setTimeout(function(){t(e,n-1,i+o,i)},i)}function e(e){setTimeout(function(){t(function(){r(e),a(e)},h,p)},0)}function n(t,e){return t.classList?t.classList.contains(e):-1!==t.className.indexOf(e)}function i(t,e){return t.classList?t.classList.add(e):t.className+=" "+e}function o(){for(var t="iframe."+u,e=document.querySelectorAll(t),n=0,i=e.length;n<i;++n)s(e[n])}function s(t,o){if(o=o||{},"IFRAME"!==t.tagName)throw new Error("Cannot render non-iframe elements!");if(!n(t,u))throw new Error("Cannot render iframes with no "+u+" class!");var s=n(t,m);if(!s||o.force){t.style.height=0,t.frameBorder=0,t.style.border="none",t.style.overflow="hidden",t.width="100%";if(!!t.srcdoc)"complete"===t.contentWindow.document.readyState?e(t):s||t.addEventListener("load",function(){e(t)},!1);else{var r=t.getAttribute("srcdoc");r&&"string"==typeof r&&(t.contentWindow.contents=r,t.src='javascript:window["contents"]',e(t))}i(t,m)}}function r(t){var e=t.contentWindow&&t.contentWindow.document,n=e&&e.body;n&&(n.style.padding=0,n.style.margin=0,n.style.overflow="hidden")}function a(t){var e=t.contentWindow&&t.contentWindow.document;if(e){var n=e.documentElement&&e.documentElement.scrollHeight||e.body&&e.body.scrollHeight||0;t.style.height=n+"px"}}function c(t){var e=document.createElement("div");e.innerHTML=(t||"").trim();var n=e.firstChild,i=n&&"IFRAME"===n.tagName,o=n&&!n.nextSibling;return i&&o}function l(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML}function d(t){return c(t)?t:'<iframe srcdoc="<html><head></head><body>'+l(t).replace(/\"/g,"&quot;")+'</body></html>" class="'+u+'"></iframe>'}var u="fenced",m="fenced-rendered",p=300,h=12;return{render:s,renderAll:o,isSafeCode:c,wrap:d}}.call(e,n,e,t))&&(t.exports=i)},644:function(t,e,n){var i,o;i=[n(85),n(264),n(265),n(53),n(30),n(6),n(266),n(54),n(198)],void 0!==(o=function(t,e,n,i,o,s,r,a,c){function l(){for(var l=[],d=-1,u=arguments.length,m=i(),p=t,h=p===t,f=i();++d<u;){var g=arguments[d];(s(g)||o(g))&&(l.push(g),m.push(h&&g.length>=r&&n(d?l[d]:f)))}var v=l[0],b=-1,y=v?v.length:0,w=[];t:for(;++b<y;){var C=m[0];if(g=v[b],(C?e(C,g):p(f,g))<0){for(d=u,(C||f).push(g);--d;)if(C=m[d],(C?e(C,g):p(l[d],g))<0)continue t;w.push(g)}}for(;u--;)(C=m[u])&&c(C);return a(m),a(f),w}return l}.apply(e,i))&&(t.exports=o)},646:function(t,e,n){var i,o;i=[n(652),n(9)],void 0!==(o=function(t,e){function n(n){return t(n,e(arguments,1))}return n}.apply(e,i))&&(t.exports=o)},652:function(t,e,n){var i,o;i=[n(85),n(264),n(265),n(266),n(198)],void 0!==(o=function(t,e,n,i,o){function s(s,r){var a=-1,c=t,l=s?s.length:0,d=l>=i,u=[];if(d){var m=n(r);m?(c=e,r=m):d=!1}for(;++a<l;){var p=s[a];c(r,p)<0&&u.push(p)}return d&&o(r),u}return s}.apply(e,i))&&(t.exports=o)},682:function(t,e){t.exports='<li class="<%=articleType%>-lightbox__item <%=articleType%>-lightbox__item--img js-<%=articleType%>-slide">\n    <div class="<%=articleType%>-lightbox__img-container"><img class="<%=articleType%>-lightbox__img js-<%=articleType%>-lightbox-img"></div>\n    <div class="<%=articleType%>-lightbox__info js-<%=articleType%>-lightbox-info">\n        <div class="<%=articleType%>-lightbox__progress <%=articleType%>-lightbox__progress--info">\n            <span class="<%=articleType%>-lightbox__index"><%=index%></span>\n            <span class="<%=articleType%>-lightbox__progress-separator"></span>\n            <span class="<%=articleType%>-lightbox__count"><%=count%></span>\n            </div>\n        <div class="<%=articleType%>-lightbox__img-caption"><%=caption%></div>\n        <div class="<%=articleType%>-lightbox__img-credit"><%=credit%></div>\n        <div class="block-share block-share--<%=articleType%> hide-on-mobile" data-link-name="block share">\n            <%=shareButtons%>\n        </div>\n        <div class="block-share--<%=articleType%>-mobile" data-open-overlay-on-click="share-modal-<%=index%>" data-link-name="open mobile block share">\n            <button class="block-share__item--mobile button button--small button--tone-media-variant mobile-only">\n                Share\n            </button>\n        </div>\n    </div>\n    <div id="share-modal-<%=index%>" class="overlay share-modal overlay--<%=articleType%> js-share-modal">\n        <div class="share-modal__content" data-link-name="mobile block share">\n            <div class="share-modal__title">Share this post</div>\n            <%=shareButtonsMobile%>\n            <button class="share-modal__close js-overlay-close" data-link-name="close"><i class="i i-close-icon-dark-small"></i><span class="u-h">close</span></button>\n        </div>\n    </div>\n</li>\n'},683:function(t,e){t.exports='<div class="gallery-lightbox__btn gallery-lightbox__btn--<%=label%> js-gallery-<%=label%>">\n<button data-link-name="gallery-lightbox <%=label%>" class="gallery-lightbox__btn-body"><i></i><%=label%></button>\n</div>'},684:function(t,e){t.exports='<li class="gallery-lightbox__item gallery-lightbox__item--endslate js-gallery-slide">\n<div class="gallery-lightbox__endslate js-gallery-endslate fc-container--media"></div>\n</li>'},685:function(t,e){t.exports='<div class="pamplemousse gallery-lightbox__loader js-loader">\n<div class="pamplemousse__pip"><i></i></div>\n<div class="pamplemousse__pip"><i></i></div>\n<div class="pamplemousse__pip"><i></i></div>\n</div>'},686:function(t,e){t.exports='<aside class="element element-rich-link element-rich-link--tag element--thumbnail element-rich-link--not-upgraded" data-component="rich-link-tag" data-link-name="rich-link-tag">\n    <p><a href="<%=href%>"><%=href%></a></p>\n</aside>\n'},687:function(t,e){t.exports='<a class="share-modal__link" href="<%=url%>" target="_blank" data-link-name="social <%=css%>">\n    <div class="share-modal__item button button--xlarge share-modal__item--<%=css%>">\n        <%= icon %>\n        <%=text%>\n    </div>\n</a>\n'},688:function(t,e){t.exports='<a class="rounded-icon block-share__item block-share__item--<%=css%> js-blockshare-link" href="<%=url%>" target="_blank" data-link-name="social <%=css%>">\n    <span class="u-h"><%=text%></span>\n    <%= icon %>\n</a>\n'},689:function(t,e){t.exports='<%= icon %><span class="sharecount__value sharecount__value--short">0</span> Shares\n'},690:function(t,e){t.exports='<h3 class="sharecount__heading"><%=icon%><span class="sharecount__text u-h">Shares</span></h3>\n<div class="sharecount__value sharecount__value--full">0</div>\n<div class="sharecount__value sharecount__value--short">0</div>\n'},700:function(t,e){t.exports='<div class="js-live-notifications-explainer live-notifications-explainer" data-link-name="notifications-explainer">\n    <div class="live-notifications-explainer__content">\n        <div class="live-notifications-explainer__header">\n                <h2 class="live-notifications-explainer__headline">Get alerts and stay up to date</h2>\n                <div class="live-notifications-explainer__header-blurb">Receive notifications on your device when important updates on this story are published</div>\n        </div>\n        <div class="live-notifications-explainer__item-options">\n            <button class="js-live-notifications__item__close button button--tertiary u-faux-block-link__promote"\n                    aria-label="Dismiss"\n                    data-link-name="close button"><%=closeIcon%>\n            </button>\n        </div>\n    </div>\n    <%= imgMobile %>\n    <%= imgDesktop %>\n</div>\n'},701:function(t,e){t.exports='<% if (isSubscribed) { %>\n    <div class="live-notifications__slider live-notifications__slider--subscribed"></div>\n    <span class="live-notifications__label live-notifications__label--subscribed">Receive updates on this story<span class="u-h"> - turn off</span></span>\n<% } else { %>\n    <div class="live-notifications__slider live-notifications__slider--unsubscribed"></div>\n    <span class="live-notifications__label live-notifications__label--unsubscribed">Receive updates on this story<span class="u-h"> - turn on</span></span>\n<% } %>\n'},702:function(t,e){t.exports='<div class="js-live-notifications-denied live-notifications-denied">\n    <div class="live-notifications-denied__content">\n        <div class="live-notifications-denied__header">Looks like you\'ve blocked notifications! If you\'ve changed your mind, click the lock to control your notifications</div>\n        <div class="live-notifications-denied__item-options">\n            <button class="js-live-notifications-denied__item__close button button--tertiary u-faux-block-link__promote"\n                    aria-label="Dismiss"\n                    data-link-name="close button"><%=closeIcon%></button>\n        </div>\n    </div>\n</div>\n'},703:function(t,e){t.exports='<div class="selection-sharing">\n    <ul class="social u-unstyled u-cf" data-component="social-selection">\n        <li class="social__item" data-link-name="twitter">\n            <a  class="rounded-icon social-icon social-icon--twitter js-selection-twitter"\n                data-link-name="social-selection"\n                target="_blank"\n                href="#">\n                <span class="u-h">Share on Twitter</span>\n                <%= twitterIcon %>\n            </a>\n        </li>\n        <li class="social__item" data-link-name="email">\n            <a  class="rounded-icon social-icon social-icon--email js-selection-email"\n                data-link-name="social-selection"\n                target="_blank"\n                href="#">\n                <span class="u-h">Share via Email</span>\n                <%= emailIcon %>\n            </a>\n        </li>\n    </ul>\n</div>\n'},793:function(t,e,n){var i,o;i=[n(476),n(413),n(882)],void 0!==(o=function(t,e,n){return{init:function(){t(),e(),n.init()}}}.apply(e,i))&&(t.exports=o)},794:function(t,e,n){var i,o;i=[n(5),n(22),n(0),n(14),n(4),n(62),n(541),n(828),n(405),n(554),n(829),n(830),n(476),n(413),n(42)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u,m,p,h){var f={initCmpParam:function(){var t=s.getUrlVars();t.CMP&&e(".element-pass-cmp").each(function(e){e.src=e.src+"?CMP="+t.CMP})},initRightHandComponent:function(){var e=t(".js-content-main-column");e[0]&&e[0].offsetHeight>1150&&i.isBreakpoint({min:"desktop"})?l.render():o.emit("modules:onward:geo-most-popular:cancel")},initQuizListeners:function(){o.on("quiz/ophan-event",h.record)}};return{init:function(){p(),m(),f.initRightHandComponent(),f.initCmpParam(),f.initQuizListeners(),r.upgradeRichLinks(),r.insertTagRichLink(),a.upgradeEvents(),o.emit("page:article:ready"),d.handleCompletion(),u.init()},modules:f}}.apply(e,i))&&(t.exports=o)},799:function(t,e,n){var i,o;i=[n(5),n(0),n(4),n(38),n(413)],void 0!==(o=function(t,e,n,i,o){var s=function(){var e=new i,o=t(".js-gallery-most-popular")[0];e.manipulationType="html",e.endpoint="/gallery/most-viewed.json",e.ready=function(){n.emit("page:new-content",o)},e.fetch(o,"html")};return{init:function(){o(),n.emit("ui:images:upgradePictures"),n.emit("page:gallery:ready"),e.page.showRelatedContent&&s()}}}.apply(e,i))&&(t.exports=o)},800:function(t,e,n){var i,o;i=[n(15),n(5),n(23),n(50),n(22),n(0),n(13),n(52),n(12),n(132),n(189),n(131),n(237),n(701),n(700),n(702),n(234),n(137),n(646),n(415),n(42)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u,m,p,h,f,g,v,b,y,w){var C={getReg:function(){return navigator.serviceWorker.ready},getSub:function(){return C.getReg().then(function(t){return t.pushManager.getSubscription()})},init:function(){C.addButtonPromise().then(function(){var t=C.configureSubscribeButton();C.trackFollowButtonAttention(t.get(0))})},addButtonPromise:function(){var t=o(".js-live-notifications");return i.write(function(){t.append('<button class="js-notifications__toggle notifications__toggle notifications-follow-input--solo"></button><span class="live-notifications__label js-live-notifications__label--denied live-notifications__label--hidden">Oops! You need to <a href="https://support.google.com/chrome/answer/3220216">unblock notifications</a> for www.theguardian.com</span>')})},trackFollowButtonAttention:function(t){t&&w.trackComponentAttention("web-notifications--follow-button",t)},configureSubscribeButton:function(){var t=o(".js-notifications__toggle"),e=C.checkSubscriptions(),s=e?C.unSubscribeHandler:C.subscribeHandler,r=c(p,{isSubscribed:e,icon:d.inlineSvg(e?"notificationsOff":"notificationsOn")});return y(t)||i.write(function(){e?t.attr("data-link-name","live-blog-notifications-turned-off"):t.attr("data-link-name","live-blog-notifications-turned-on"),t.html(r),n.one(t[0],"click",s)}),t},subscribeHandler:function(){var t="granted"!==Notification.permission;C.subscribe().then(C.follow).then(function(){var e="granted"===Notification.permission;t&&e&&m.trackNonClickInteraction("browser-notifications-granted")}).catch(function(){"denied"===Notification.permission&&m.trackNonClickInteraction("browser-notifications-denied"),C.configureSubscribeButton()})},unSubscribeHandler:function(){C.unFollow().then(C.unSubscribe)},subscribe:function(){return C.getReg().then(function(t){return C.getSub().then(function(e){return e||t.pushManager.subscribe({userVisibleOnly:!0})}).catch(function(t){throw i.write(function(){var t=o(".js-live-notifications__label--denied");t.removeClass("live-notifications__label--hidden"),t.addClass("live-notifications__label--visible")}),t})})},follow:function(){C.updateSubscription("/notification/store").then(function(){var t=C.getSubscriptions();t.push(s.page.pageId),u.set("subscriptions",v(t)),C.configureSubscribeButton()})},unSubscribe:function(){C.subscriptionsEmpty()&&C.getSub().then(function(t){t.unsubscribe().catch(function(t){l.logError("07cm-frontendNotificatons",t)})}),C.configureSubscribeButton()},unFollow:function(){return C.updateSubscription("/notification/delete").then(function(){var t=C.getSubscriptions(),e=b(t,s.page.pageId);u.set("subscriptions",v(e))})},updateSubscription:function(t){return C.getSub().then(function(e){var n=e&&e.endpoint;if(n)return a(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:{browserEndpoint:n,notificationTopicId:s.page.pageId}})})},hasSubscribed:function(){return u.get("subscriptions")},getSubscriptions:function(){return C.hasSubscribed()||[]},subscriptionsEmpty:function(){return!C.getSubscriptions().length},checkSubscriptions:function(){var t=C.getSubscriptions();return g(t,function(t){return t==s.page.pageId})}};return{init:C.init}}.apply(e,i))&&(t.exports=o)},803:function(t,e,n){var i,o;i=[n(15),n(23)],void 0!==(o=function(t,e){return function(n,i,o){var s,r=n.clientHeight,a=getComputedStyle(n).getPropertyValue("line-height"),c=(parseInt(a,10)+(o?2:0))*i,l=t(t.create('<span class="clamp-fade"></span>')),d=t(n);r<c||(d.css({maxHeight:c+"px",overflow:"hidden"}),d.after(l),o&&(s=t(t.create('<span class="clamp-fade__content u-fauxlink" role="button">Read more</span>')),l.append(s),e.on(s[0],"click",function(){l.remove(),d.css({maxHeight:"none",overflow:"auto"})})))}}.apply(e,i))&&(t.exports=o)},804:function(t,e,n){var i;void 0!==(i=function(){var t,e=function(){if(void 0===t){var e=document.createElement("p"),n=document.createElement("p"),i=document.createTextNode("aa"),o=document.createTextNode("aa"),s=document.createRange();e.appendChild(i),n.appendChild(o),document.body.appendChild(e),document.body.appendChild(n),s.setStart(i,1),s.setEnd(o,1),t=s.getClientRects().length>2,document.body.removeChild(e),document.body.removeChild(n)}return t},n=function(t){if(!e())return t.getClientRects();for(var n=[],i=t.endContainer,o=t.endOffset,s=document.createRange();i!==t.commonAncestorContainer;)s.setStart(i,0),s.setEnd(i,o),Array.prototype.push.apply(n,s.getClientRects()),o=Array.prototype.indexOf.call(i.parentNode.childNodes,i),i=i.parentNode;return s=t.cloneRange(),s.setEnd(i,o),Array.prototype.push.apply(n,s.getClientRects()),n};return{getClientRects:n,getBoundingClientRect:function(t){var i,o,s,r=n(t),a=t.getBoundingClientRect();if(0===r.length)return null;if(!e())return t.getBoundingClientRect();if(0===a.width&&0===a.height)return r[0];for(i=0,o=r.length;i<o;i++)s=s||{left:r[i].left,top:r[i].top,right:r[i].right,bottom:r[i].bottom},s.left=Math.min(s.left,r[i].left),s.top=Math.min(s.top,r[i].top),s.right=Math.max(s.right,r[i].right),s.bottom=Math.max(s.bottom,r[i].bottom);return s&&(s.width=s.right-s.left,s.height=s.bottom-s.top),s}}}.call(e,n,e,t))&&(t.exports=i)},828:function(t,e,n){var i,o;i=[n(20),n(22),n(29),n(61)],void 0!==(o=function(t,e,n,i){function o(o){var s=e("a",o).attr("href");s.match(/https:\/\/membership.theguardian.com/)&&n(s+"/card",{mode:"cors"}).then(function(n){n.html&&t.write(function(){e(o).html(n.html).removeClass(r).addClass(a)})}).catch(function(t){i(t,{feature:"membership-events"})})}function s(){e("."+r).each(o)}var r="element-membership--not-upgraded",a="element-membership--upgraded";return{upgradeEvent:o,upgradeEvents:s}}.apply(e,i))&&(t.exports=o)},829:function(t,e,n){var i,o;i=[n(23),n(22),n(50),n(239)],void 0!==(o=function(t,e,n,i){return{handleCompletion:function(){if(HTMLFormElement.prototype.checkValidity){var o=e(".js-atom-quiz--instant-reveal");o.length>0&&t.on(document,"click",i(o),function(t){var i=t.currentTarget,o=e(":checked + .atom-quiz__answer__item--is-correct",i).length;if(i.checkValidity()){var s=null;do{if(s=e(".js-atom-quiz__bucket-message--"+o,i),s.length>0){n.write(function(){s.css({display:"block"})});break}o--}while(o>=0)}})}}}}.apply(e,i))&&(t.exports=o)},830:function(t,e,n){var i,o;i=[n(4),n(14),n(22),n(23),n(42)],void 0!==(o=function(t,e,n,i,o){function s(t){t.preventDefault();var e=t.currentTarget.querySelector(".user__question-upvote"),i=n(".js-storyquestion-atom-id");if(e&&i){var s=e.id,r=i.attr("id"),a=document.querySelector("meta[name=js-notranslate-"+s+"]");if(a){var c=a.content;if(c&&r){var l=n("#"+s),d=n("#js-question-thankyou-"+s);l&&d&&(l.addClass("is-hidden"),d.removeClass("is-hidden")),o.record({atomId:r.trim(),component:c.trim(),value:"question_asked"})}}}}return{init:function(){var r=n(".js-ask-question-link");r&&r.each(function(t){i.on(t,"click",s)});var a=document.querySelector(".js-view-tracking-component"),c=n(".js-storyquestion-atom-id");a&&c&&t.on("window:throttledScroll",function n(){var i=e.getViewport().height,s=a.getBoundingClientRect();if(0<=s.top&&s.bottom<=i){var r=c.attr("id");r&&o.record({atomId:r.trim(),component:r.trim(),value:"question_component_in_view"}),t.off("window:throttledScroll",n)}})}}}.apply(e,i))&&(t.exports=o)},849:function(t,e,n){var i,o;i=[n(23),n(15),n(4),n(20),n(454)],void 0!==(o=function(t,e,n,i,o){var s=function(s){o(this,"checkPosition","calculateContainerPositioning"),t.on(window,"click",this.checkPosition),n.addListener("window:throttledScroll",this.checkPosition),n.addListener("window:throttledResize",function(){i.write(this.calculateContainerPositioning)}),this.affixed=null,this.$markerTop=e(s.topMarker),this.$markerBottom=e(s.bottomMarker),this.$container=e(s.containerElement),this.$element=e(s.element),this.$window=e(document.body),this.checkPosition(),i.write(this.calculateContainerPositioning)};return s.CLASS="affix",s.CLASSY_BOTTOM="affix-bottom",s.prototype.calculateContainerPositioning=function(){var t=this;this.$container.css("top","0"),i.read(function(){var e=t.$markerTop.offset().top-t.$container.offset().top;i.write(function(){t.$container.css("top",e+"px")})})},s.prototype.getPixels=function(t){return"auto"!==t?parseInt(t,10):0},s.prototype.checkPosition=function(){var t,n,o=this,r=this.$window.scrollTop(),a=this.$markerTop.offset().top,c=this.$markerBottom.offset().top,l=this.$element.dim().height,d=r>=a,u=r+l<c,m=l<e.viewport().height,p=u&&d&&m;this.affixed!==p&&(this.affixed=p,u?i.write(function(){o.$container.removeClass(s.CLASSY_BOTTOM),o.calculateContainerPositioning()}):(t=this.getPixels(this.$container.css("top")),n=c-a-l+t,i.write(function(){o.$container.css("top",n+"px"),o.$container.addClass(s.CLASSY_BOTTOM)})),i.write(function(){p?o.$element.addClass(s.CLASS):o.$element.removeClass(s.CLASS)}))},s}.apply(e,i))&&(t.exports=o)},859:function(t,e,n){var i,o;i=[n(29),n(50),n(15),n(506)],void 0!==(o=function(t,e,n,i){function o(t){return t}function s(s,r){if(r=i({beforeInsert:o,force:!1,finally:o,catch:o},r),s&&r.container){var a=n(r.container);if(r.force||!a.hasClass("lazyloaded"))return t(s,{mode:"cors"}).then(function(t){return e.write(function(){return a.html(r.beforeInsert(t.html)).addClass("lazyloaded"),t})}).then(r.finally).catch(r.catch)}}return s}.apply(e,i))&&(t.exports=o)},865:function(t,e,n){var i,o;i=[n(5),n(0),n(38),n(4),n(232)],void 0!==(o=function(t,e,n,i,o){function s(){var t=["info","global"];i.emit("register:begin","popular-in-section"),this.hasSection=e.page&&e.page.section&&!o(t,e.page.section),this.endpoint="/most-read"+(this.hasSection?"/"+e.page.section:"")+".json"}return n.define(s),s.prototype.init=function(){this.fetch(t(".js-popular-trails"),"html")},s.prototype.ready=function(){i.emit("modules:popular:loaded",this.elem),i.emit("page:new-content",this.elem),i.emit("register:end","popular-in-section")},s}.apply(e,i))&&(t.exports=o)},866:function(t,e,n){var i,o;i=[n(15),n(5),n(22),n(0),n(4),n(396),n(859),n(880),n(644),n(230)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l){function d(t){u=t||{}}var u;return d.prototype.popularInTagOverride=function(){if(!i.page.keywordIds)return!1;var t=["sport/cricket","sport/rugby-union","sport/rugbyleague","sport/formulaone","sport/tennis","sport/cycling","sport/motorsports","sport/golf","sport/horse-racing","sport/boxing","sport/us-sport","sport/australia-sport","football/championsleague","football/premierleague","football/championship","football/europeanfootball","football/world-cup-2014","football/manchester-united","football/chelsea","football/arsenal","football/manchestercity","football/tottenham-hotspur","football/liverpool"],e=i.page.keywordIds.split(","),n=i.page.isPaidContent?e:c(t,e);return n.length?"/popular-in-tag/"+n[0]+".json":void 0},d.prototype.renderRelatedComponent=function(){var e,c,d,m,p=i.switches.relatedContent&&i.page.showRelatedContent;i.page&&i.page.hasStoryPackage?new a({dom:document.body.querySelector(".related-trails"),expanded:!1,showCount:!1}).init():p?(m=document.body.querySelector(".js-related"))&&(c=this.popularInTagOverride(),d=c?"related-popular-in-tag":"related-content",s.begin(d),m.setAttribute("data-component",d),e=c||"/related/"+i.page.pageId+".json",u.excludeTags&&u.excludeTags.length&&(e+="?"+l(u.excludeTags,function(t){return"exclude-tag="+t}).join("&")),r(e,{container:m,finally:function(){var t=m.querySelector(".related-content");new a({dom:t,expanded:!1,showCount:!1}).init(),o.emit("modules:related:loaded",m),o.emit("page:new-content",m),o.emit("ui:images:upgradePictures",m),s.end(d)},catch:function(){t(m).remove(),s.error(d)}})):n(".js-related").addClass("u-h")},d}.apply(e,i))&&(t.exports=o)},868:function(t,e,n){var i,o;i=[n(0),n(4),n(396),n(38)],void 0!==(o=function(t,e,n,i){function o(){n.begin("tonal-content"),this.edition=t.page.edition.toLowerCase(),this.isSupported()?this.endpoint=this.getEndpoint():this.fetch=s}var s=function(){};return i.define(o),o.prototype.tones={uk:{features:"uk-alpha/features/feature-stories",comment:"uk-alpha/contributors/feature-stories"},us:{features:"us-alpha/features/feature-stories",comment:"us-alpha/contributors/feature-stories"},au:{features:"au-alpha/features/feature-stories",comment:"au-alpha/contributors/feature-stories"},int:{features:"22167321-f8cf-4f4a-b646-165e5b1e9a30",comment:"ee3386bb-9430-4a6d-8bca-b99d65790f3b"}},o.prototype.getEndpoint=function(){return"/container/"+this.tones[this.edition][this.getTone()]+".json"},o.prototype.isSupported=function(){return this.getTone()in this.tones[this.edition]},o.prototype.getTone=function(){return t.page.tones.split(",")[0].toLowerCase()},o.prototype.ready=function(){var t=document.body.querySelector(".tone-feature");e.emit("page:new-content",t),e.emit("ui:images:upgradePictures"),e.emit("modules:tonal:loaded"),n.end("tonal-content")},o.prototype.error=function(){n.error("tonal-content")},o}.apply(e,i))&&(t.exports=o)},869:function(t,e,n){var i,o;i=[n(22),n(803),n(38)],void 0!==(o=function(t,e,n){var i=function(t,e){this.mediator=t,this.setOptions(e)};return n.define(i),i.prototype.endpoint="/open/cta/article/:discussionKey.json",i.prototype.componentClass="comment",i.prototype.useBem=!0,i.prototype.defaultOptions={discussionKey:null},i.prototype.prerender=function(){var e=t(".comment",this.elem),n=e[Math.floor(Math.random()*e.length)+0];0===e.length?this.destroy():this.elem=n},i.prototype.ready=function(){e(this.getElem("body"),10,!0)},i}.apply(e,i))&&(t.exports=o)},876:function(t,e,n){var i,o;i=[n(50),n(23),n(15),n(5),n(22),n(29),n(0),n(14),n(4),n(542),n(16),n(449),n(235),n(239),n(398),n(884),n(242)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u,m,p,h,f,g){return function(r){var v=d({toastOffsetTop:12,minUpdateDelay:1e3*(a.isBreakpoint({min:"desktop"})?10:30),maxUpdateDelay:12e5,backoffMultiplier:.75},r),b=o(".js-liveblog-body"),y=o(".toast__button"),w=o(".toast__text",this.$toastButton),C=i(".toast__container")[0],_=v.minUpdateDelay,x=b.data("most-recent-block"),k=0,S=void 0,T=function(t){var e;e=a.pageVisible()?v.minUpdateDelay:Math.min(1.5*t,v.maxUpdateDelay),_=e},E=function(){return b.offset().top<window.pageYOffset},j=-1===window.location.search.indexOf("?page="),I=function(){t.write(function(){o(".autoupdate--hidden",b).addClass("autoupdate--highlight").removeClass("autoupdate--hidden"),c.emit("modules:autoupdate:unread",0)})},P=function(){t.write(function(){if(k>0){var t=k>1?" new updates":" new update";y.removeClass("toast__button--closed"),o(C).addClass("toast__container--open"),w.html(k+t)}else y.removeClass("loading").addClass("toast__button--closed"),o(C).removeClass("toast__container--open")})},A=function(e){var i,s=o.create("<div>"+e+"</div>")[0];t.write(function(){n(s.children).addClass("autoupdate--hidden"),i=p(s.children),b.prepend(i),c.emit("modules:autoupdate:updates",i.length),h.init(),l.enhanceTweets(),g.checkElemsForVideos(i)})},R=function(){a.pageVisible()&&I(),k=0,P()},L=function(){void 0!=S&&clearTimeout(S);var t="&isLivePage="+(j?"true":"false"),e=x||"block-0",n=0,i=window.location.pathname+".json?lastUpdate="+e+t,o=function(){0==n||_>0?(T(_),S=setTimeout(L,_)):S=setTimeout(L,1)};return s(i,{mode:"cors"}).then(function(t){n=t.numNewBlocks,n>0&&(k+=n,c.emit("modules:autoupdate:unread",k),x=t.mostRecentBlockId,j?(A(t.html),E()?P():R()):P()),o()}).catch(function(){o()})};(new f).init(),new u.Sticky(C,{top:v.toastOffsetTop,emitMessage:!0,containInParent:!1}).init(),L(),a.initPageVisibility(),function(){e.on(document.body,"click",".toast__button",function(){j?t.read(function(){m.scrollToElement(i(".blocks")[0],300,"easeOutQuad"),t.write(function(){y.addClass("loading")}).then(function(){R()})}):location.assign(window.location.pathname)}),c.on("modules:toast__tofix:unfixed",function(){j&&k>0&&t.write(function(){y.addClass("loading")}).then(function(){R()})}),c.on("modules:detect:pagevisibility:visible",function(){0==k&&I(),_=0,L()})}(),t.write(function(){b.addClass("autoupdate--has-animation")})}}.apply(e,i))&&(t.exports=o)},880:function(t,e,n){var i,o;i=[n(22),n(23),n(15)],void 0!==(o=function(t,e,n){return function(i){var o=i||{},s=t(o.dom),r=!1!==o.expanded,a=document.createElement("button"),c=!1!==o.showCount,l=function(){r?s.removeClass("shut"):s.addClass("shut")},d=function(){return parseInt(s.attr("data-count"),10)},u=function(){var t="Show ";c&&(t+=d()+" "),t+=r?"fewer":"more",a.innerHTML=t,a.setAttribute("data-link-name","Show "+(r?"more":"fewer")),a.setAttribute("data-is-ajax","1")},m={toggleExpanded:function(){r=!r,l(),u()},getCount:d,isOpen:function(){return!s.hasClass("shut")}},p={updateCallToAction:u,renderState:l,renderCallToAction:function(){e.add(a,"click",function(){m.toggleExpanded()}),a.className="cta",o.buttonAfterEl?n(o.buttonAfterEl).after(a):s[0].appendChild(a),p.updateCallToAction()},scrollToCallToAction:function(){r||window.setTimeout(function(){a.scrollIntoView()},550)}};return{init:function(){if(s.hasClass("expandable-initialised")||!s.html()||m.getCount()<3)return!1;s.addClass("expandable-initialised"),p.renderCallToAction(),p.renderState()},toggle:m.toggleExpanded}}}.apply(e,i))&&(t.exports=o)},882:function(t,e,n){var i,o;i=[n(50),n(22),n(4),n(14)],void 0!==(o=function(t,e,n,i){var o=function(e){return t.write(function(){e.$el.css("height","")}).then(function(){if(e.isMobile)return t.read(function(){return e.$el.height()}).then(function(n){return t.write(function(){e.$el.css("height",n)})})})},s=function(t){t.elements.each(function(n){o({$el:e(n),isMobile:t.isMobile})})},r=function(){return t.read(function(){return{elements:e(".js-is-fixed-height"),isMobile:"mobile"===i.getBreakpoint()}})},a=function(){r().then(s)};return{init:function(){n.on("window:throttledResize",a),n.on("window:orientationchange",a),a()}}}.apply(e,i))&&(t.exports=o)},883:function(t,e,n){var i,o;i=[n(23),n(20),n(5),n(22)],void 0!==(o=function(t,e,n,i){return function(){var o=i(".js-lm");o.length>0&&(e.write(function(){i(".js-wpd").addClass("content__dateline-wpd--modified")}),t.on(n(".js-wpd")[0],"click",function(){e.write(function(){o.toggleClass("u-h")})}))}}.apply(e,i))&&(t.exports=o)},884:function(t,e,n){var i,o;i=[n(4)],void 0!==(o=function(t){"use strict";function e(){}var n=document.title;return e.prototype.init=function(){var e=this;t.on("modules:autoupdate:unread",function(t){e.setCount(t)})},e.prototype.setCount=function(t){t>0?document.title="("+t+") "+n:this.restorePageTitle()},e.prototype.restorePageTitle=function(){document.title=n},e}.apply(e,i))&&(t.exports=o)},885:function(t,e,n){var i,o;i=[n(23),n(15),n(22),n(804),n(0),n(14),n(4),n(12),n(703),n(189),n(41),n(234)],void 0!==(o=function(t,e,n,i,o,s,r,a,c,l,d,u){var m,p,h=e(document.body),f=l.inlineSvg("shareTwitter",["icon","centered-icon"]),g=l.inlineSvg("shareEmail",["icon","centered-icon"]),v=a(c,{twitterIcon:f,emailIcon:g}),b=n.create(v),y=o.page.shortUrl+"/stw",w=o.page.shortUrl+"/sbl",C=["js-article__body","content__standfirst","block","caption--main","content__headline"],_=function(t){return u(C,function(e){return n.ancestor(t.startContainer,e)&&n.ancestor(t.endContainer,e)})},x=function(){b.hasClass("selection-sharing--active")&&b.removeClass("selection-sharing--active")},k=function(){b.hasClass("selection-sharing--active")||b.addClass("selection-sharing--active")},S=function(){var t,e,n,s,r,c,l=window.getSelection&&document.createRange&&window.getSelection();if(l&&l.rangeCount>0&&l.toString()){if(t=l.getRangeAt(0),e=i.getBoundingClientRect(t),n=h.scrollTop()+e.top,s=t.toString(),!_(t))return void x();s.length>114&&(s=s.slice(0,113)+"…"),r=a("https://twitter.com/intent/tweet?text=%E2%80%9C<%=text%>%E2%80%9D&url=<%=url%>",{text:encodeURIComponent(s),url:encodeURI(y)}),c=a("mailto:?subject=<%=subject%>&body=%E2%80%9C<%=selection%>%E2%80%9D <%=url%>",{subject:encodeURI(o.page.webTitle),selection:encodeURI(t.toString()),url:encodeURI(w)}),m.attr("href",r),p.attr("href",c),b.css({top:n+"px",left:e.left+"px"}),k()}else x()},T=function(t){n.ancestor(t.target,"social__item")||x()};return{init:function(){s.hasTouchScreen()||(h.append(b),m=n(".js-selection-twitter"),p=n(".js-selection-email"),t.on(document.body,"keypress keydown keyup",d(S,50)),t.on(document.body,"mouseup",d(S,200)),t.on(document.body,"mousedown",d(T,50)),r.on("window:throttledResize",S))},updateSelection:S}}.apply(e,i))&&(t.exports=o)}});
//# sourceMappingURL=graun.article.js.map